<!-- beyondBINARY quantum-prefixed | uvspeed | {+1, 1, -1, +0, 0, -0, +n, n, -n} -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#0d1117">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="icon" type="image/png" sizes="32x32" href="../icons/favicon.png">
<link rel="apple-touch-icon" sizes="192x192" href="../icons/icon-192.png">
<title>uvspeed â€” Quantum Gutter Â· Prefix System</title>
<style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; scrollbar-width: thin; scrollbar-color: #30363d #0d1117; }
    body {
        background: var(--qp-bg, #0d1117); color: var(--qp-text, #e6edf3);
        font-family: -apple-system, 'SF Pro Display', BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
        line-height: 1.6; overflow-x: hidden;
    }
    a { color: #58a6ff; text-decoration: none; }
    a:hover { text-decoration: underline; }
    code { font-family: 'SF Mono', 'Fira Code', monospace; font-size: 0.8125em; background: #161b22; padding: 2px 6px; border-radius: 4px; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0d1117; }
    ::-webkit-scrollbar-thumb { background: #30363d; border-radius: 3px; }

    /* â”€â”€ Rainbow â”€â”€ */
    .rainbow { display: flex; flex-shrink: 0; height: 3px; width: 100%; }
    .rainbow span { flex: 1; }
    .r1 { background: #ff3838; } .r2 { background: #ff8c38; } .r3 { background: #ffe138; }
    .r4 { background: #3fb950; } .r5 { background: #38a5ff; } .r6 { background: #bc8cff; }
    .rainbow-glow {
        height: 60px; width: 100%;
        background: linear-gradient(180deg,
            rgba(255,56,56,0.08) 0%, rgba(255,140,56,0.06) 16%, rgba(255,225,56,0.05) 33%,
            rgba(63,185,80,0.04) 50%, rgba(56,165,255,0.03) 66%, rgba(188,140,255,0.02) 83%, transparent 100%);
    }

    /* â”€â”€ Hero â”€â”€ */
    .hero { position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 80px 24px 60px; text-align: center; overflow: hidden; }
    #hero-canvas { position: absolute; inset: 0; z-index: 0; }
    .hero-content { position: relative; z-index: 1; max-width: 760px; }
    .hero-badge { display: inline-block; font-family: 'SF Mono', monospace; font-size: 0.6875rem; color: #8b949e; border: 1px solid #30363d; border-radius: 999px; padding: 4px 14px; margin-bottom: 24px; background: rgba(22,27,34,0.8); backdrop-filter: blur(8px); }
    .hero-badge .dot { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: #3fb950; margin-right: 6px; vertical-align: middle; }
    .hero h1 { font-size: clamp(2.5rem, 6vw, 4.5rem); font-weight: 800; letter-spacing: -2px; line-height: 1.05; margin-bottom: 16px; }
    .hero h1 .gradient { background: linear-gradient(135deg, #e2b714 0%, #6a9955 20%, #569cd6 40%, #c586c0 60%, #f44747 80%, #4ec9b0 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero p { font-size: 1.125rem; color: #8b949e; max-width: 560px; margin: 0 auto 32px; }
    .hero-actions { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
    .btn { display: inline-flex; align-items: center; gap: 8px; padding: 12px 28px; border-radius: 8px; border: none; font-size: 0.9375rem; font-weight: 600; cursor: pointer; text-decoration: none; transition: all 0.2s; font-family: inherit; }
    .btn-primary { background: linear-gradient(135deg, #e2b714, #6a9955, #569cd6, #c586c0, #f44747, #4ec9b0); background-size: 300% 300%; animation: gradShift 4s ease infinite; color: #0d1117; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(88,166,255,0.3); text-decoration: none; }
    .btn-secondary { background: rgba(22,27,34,0.8); color: #e6edf3; border: 1px solid #30363d; backdrop-filter: blur(8px); }
    .btn-secondary:hover { background: #21262d; border-color: #484f58; text-decoration: none; }
    @keyframes gradShift { 0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%} }

    /* â”€â”€ Sections â”€â”€ */
    section { max-width: 1100px; margin: 0 auto; padding: 80px 24px; }
    section h2 { font-size: 2rem; font-weight: 700; letter-spacing: -0.5px; margin-bottom: 8px; }
    .section-sub { color: #8b949e; font-size: 1rem; margin-bottom: 48px; max-width: 600px; }

    /* â”€â”€ Stats ribbon â”€â”€ */
    .stats-ribbon { display: flex; justify-content: center; gap: 40px; padding: 32px 24px; border-top: 1px solid #21262d; border-bottom: 1px solid #21262d; background: #161b22; flex-wrap: wrap; }
    .stat { text-align: center; }
    .stat .number { font-family: 'SF Mono', monospace; font-size: 2rem; font-weight: 800; background: linear-gradient(135deg, #e2b714, #569cd6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .stat .label { font-size: 0.75rem; color: #8b949e; text-transform: uppercase; letter-spacing: 1px; margin-top: 2px; }

    /* â”€â”€ Prefix Cube â”€â”€ */
    .prefix-cube-wrap { display: flex; flex-direction: column; align-items: center; margin-bottom: 48px; }
    .prefix-cube-canvas { width: 100%; max-width: 420px; aspect-ratio: 1; border-radius: 16px; border: 1px solid #21262d; background: rgba(13,17,23,0.7); backdrop-filter: blur(8px); cursor: grab; touch-action: none; }
    .prefix-cube-canvas:active { cursor: grabbing; }
    .prefix-cube-hint { font-size: 0.6875rem; color: #484f58; margin-top: 8px; font-family: 'SF Mono', monospace; letter-spacing: 0.5px; }
    [data-theme="light"] .prefix-cube-canvas { background: rgba(240,242,245,0.85); border-color: var(--qp-border, #d0d7de); }

    /* â”€â”€ Symbol table â”€â”€ */
    .sym-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 10px; }
    .sym-card { background: #161b22; border: 1px solid #21262d; border-radius: 10px; padding: 16px; transition: all 0.2s; cursor: default; }
    .sym-card:hover { border-color: #30363d; transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.4); }
    .sym-card .sym { font-family: 'SF Mono', monospace; font-size: 1.25rem; font-weight: 800; margin-bottom: 4px; }
    .sym-card .cat { font-size: 0.6875rem; color: #8b949e; text-transform: uppercase; letter-spacing: 0.5px; }
    .sym-card .desc { font-size: 0.75rem; color: #8b949e; margin-top: 6px; line-height: 1.4; }

    /* â”€â”€ Live editor â”€â”€ */
    .live-editor { display: grid; grid-template-columns: 1fr 1fr; gap: 0; border: 1px solid #21262d; border-radius: 12px; overflow: hidden; background: #0d1117; }
    .live-editor .editor-pane { display: flex; flex-direction: column; }
    .live-editor .pane-header { padding: 10px 16px; background: #161b22; border-bottom: 1px solid #21262d; font-size: 0.75rem; font-weight: 600; color: #8b949e; display: flex; justify-content: space-between; align-items: center; }
    .live-editor textarea { flex: 1; background: #0d1117; color: #e6edf3; border: none; padding: 16px; font-family: 'SF Mono', 'Fira Code', monospace; font-size: 0.8125rem; line-height: 2; resize: none; outline: none; min-height: 320px; }
    .live-editor .gutter-pane { font-family: 'SF Mono', monospace; font-size: 0.8125rem; line-height: 2; padding: 16px; overflow-y: auto; border-left: 1px solid #21262d; min-height: 320px; }
    .live-editor .gutter-line { display: flex; gap: 8px; white-space: pre; }
    .live-editor .gl-sym { width: 28px; text-align: right; flex-shrink: 0; font-weight: 700; }
    .live-editor .gl-code { color: #8b949e; overflow: hidden; text-overflow: ellipsis; }
    .lang-select { background: #21262d; color: #e6edf3; border: 1px solid #30363d; border-radius: 4px; padding: 2px 8px; font-family: inherit; font-size: 0.6875rem; cursor: pointer; }

    /* â”€â”€ Benchmark panel â”€â”€ */
    .bench-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 16px; }
    .bench-card { background: #161b22; border: 1px solid #21262d; border-radius: 12px; padding: 24px; transition: all 0.25s; }
    .bench-card:hover { border-color: #30363d; transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
    .bench-card h4 { font-size: 0.875rem; font-weight: 700; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; }
    .bench-card .bench-value { font-family: 'SF Mono', monospace; font-size: 1.75rem; font-weight: 800; margin: 8px 0 4px; }
    .bench-card .bench-unit { font-size: 0.6875rem; color: #8b949e; }
    .bench-card .bench-bar { height: 4px; background: #21262d; border-radius: 2px; margin-top: 12px; overflow: hidden; }
    .bench-card .bench-fill { height: 100%; border-radius: 2px; transition: width 0.6s ease; }

    /* â”€â”€ Canvas showcase â”€â”€ */
    .canvas-trio { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    .canvas-card { background: #161b22; border: 1px solid #21262d; border-radius: 12px; overflow: hidden; transition: all 0.25s; }
    .canvas-card:hover { border-color: #30363d; transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
    .canvas-card canvas { width: 100%; height: 280px; display: block; cursor: crosshair; }
    .canvas-card .cc-label { padding: 12px 16px; font-size: 0.8125rem; font-weight: 600; display: flex; justify-content: space-between; align-items: center; }
    .canvas-card .cc-tag { font-size: 0.5625rem; color: #8b949e; font-family: 'SF Mono', monospace; }

    /* â”€â”€ Coverage chart â”€â”€ */
    .cov-chart { display: flex; flex-direction: column; gap: 6px; max-width: 700px; }
    .cov-row { display: flex; align-items: center; gap: 12px; }
    .cov-row .cov-lang { width: 90px; font-size: 0.8125rem; color: #8b949e; flex-shrink: 0; text-align: right; font-family: 'SF Mono', monospace; }
    .cov-row .cov-bar { flex: 1; height: 18px; background: #21262d; border-radius: 4px; overflow: hidden; position: relative; }
    .cov-row .cov-fill { height: 100%; border-radius: 4px; transition: width 1s ease; display: flex; align-items: center; justify-content: flex-end; padding-right: 6px; font-size: 0.5625rem; font-weight: 700; color: #0d1117; }

    /* â”€â”€ Architecture Flow â”€â”€ */
    .arch-flow-section { background: #161b22; border: 1px solid #21262d; border-radius: 16px; padding: 32px; margin-bottom: 40px; }
    .arch-flow-title { font-size: 1rem; font-weight: 700; margin-bottom: 16px; display: flex; align-items: center; gap: 10px; }
    .arch-flow-title .af-chip { font-size: 0.5625rem; font-family: 'SF Mono', monospace; padding: 2px 8px; border-radius: 999px; }
    .arch-stack { display: flex; flex-direction: column; gap: 0; position: relative; }
    .arch-layer {
        display: grid; grid-template-columns: 60px 60px 1fr auto;
        align-items: center; gap: 12px; padding: 10px 16px;
        border: 1px solid #21262d; border-radius: 8px; margin-bottom: 6px;
        background: #0d1117; transition: all 0.2s; font-size: 0.75rem;
    }
    .arch-layer:hover { border-color: #30363d; transform: translateX(4px); }
    .arch-layer .al-prefix { font-family: 'SF Mono', monospace; font-weight: 800; font-size: 0.8125rem; }
    .arch-layer .al-hw { font-weight: 700; color: #e6edf3; }
    .arch-layer .al-desc { color: #8b949e; font-size: 0.6875rem; }
    .arch-layer .al-stat { font-family: 'SF Mono', monospace; font-size: 0.625rem; color: #58a6ff; text-align: right; white-space: nowrap; }
    .arch-flow-arrow { text-align: center; color: #30363d; font-size: 0.75rem; margin: -2px 0; }
    .arch-stats-row { display: flex; gap: 16px; margin-top: 20px; flex-wrap: wrap; }
    .arch-stat-card { flex: 1; min-width: 140px; background: #0d1117; border: 1px solid #21262d; border-radius: 10px; padding: 14px; text-align: center; }
    .arch-stat-card .as-val { font-family: 'SF Mono', monospace; font-size: 1.25rem; font-weight: 800; }
    .arch-stat-card .as-lbl { font-size: 0.625rem; color: #8b949e; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 4px; }

    /* â”€â”€ Manufacturer Grid â”€â”€ */
    .mfg-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 14px; margin-bottom: 32px; }
    .mfg-card { background: #161b22; border: 1px solid #21262d; border-radius: 12px; padding: 20px; transition: all 0.2s; }
    .mfg-card:hover { border-color: #30363d; transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.4); }
    .mfg-card h4 { font-size: 0.9375rem; font-weight: 700; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; }
    .mfg-card .mfg-sub { font-size: 0.6875rem; color: #8b949e; margin-bottom: 10px; }
    .mfg-card .mfg-layers { list-style: none; padding: 0; }
    .mfg-card .mfg-layers li { font-size: 0.625rem; color: #8b949e; padding: 2px 0; display: flex; gap: 6px; }
    .mfg-card .mfg-layers li .mfg-pre { font-family: 'SF Mono', monospace; font-weight: 700; min-width: 28px; }
    .mfg-phase { display: inline-block; font-size: 0.5625rem; font-family: 'SF Mono', monospace; padding: 2px 8px; border-radius: 999px; margin-top: 10px; }

    /* â”€â”€ PWA Pipeline â”€â”€ */
    .pwa-pipeline { display: flex; flex-direction: column; gap: 0; margin-top: 20px; }
    .pwa-stage { display: flex; gap: 16px; align-items: flex-start; padding: 16px 0; border-bottom: 1px solid #21262d; }
    .pwa-stage:last-child { border-bottom: none; }
    .pwa-stage .ps-num { font-family: 'SF Mono', monospace; font-size: 1.5rem; font-weight: 800; min-width: 40px; }
    .pwa-stage .ps-body h4 { font-size: 0.875rem; font-weight: 700; margin-bottom: 3px; }
    .pwa-stage .ps-body p { font-size: 0.75rem; color: #8b949e; line-height: 1.5; }
    .pwa-stage .ps-tags { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 6px; }
    .pwa-stage .ps-tag { font-size: 0.5625rem; font-family: 'SF Mono', monospace; padding: 2px 8px; border-radius: 999px; background: rgba(88,166,255,0.1); color: #58a6ff; }

    /* â”€â”€ QPU Interactive Section â”€â”€ */
    .qpu-section { display: grid; grid-template-columns: 1fr 1fr; gap: 1px; background: #21262d; border-radius: 10px; overflow: hidden; margin-top: 20px; }
    .qpu-panel { background: #0d1117; padding: 16px; display: flex; flex-direction: column; }
    .qpu-controls { display: flex; flex-direction: column; gap: 8px; }
    .qpu-row { display: flex; gap: 8px; align-items: center; font-size: 0.75rem; }
    .qpu-row label { color: #8b949e; min-width: 55px; font-family: 'SF Mono', monospace; }
    .qpu-row input, .qpu-row select { flex: 1; padding: 5px 8px; background: #161b22; border: 1px solid #30363d; border-radius: 4px; color: #c9d1d9; font-family: 'SF Mono', monospace; font-size: 0.75rem; }
    .qpu-row input:focus { border-color: #a371f7; outline: none; }
    .qpu-btn { padding: 6px 14px; border: none; border-radius: 6px; font-family: 'SF Mono', monospace; font-size: 0.75rem; font-weight: 600; cursor: pointer; transition: all 0.15s; }
    .qpu-btn-run { background: #8957e5; color: #fff; }
    .qpu-btn-run:hover { background: #a371f7; }
    .qpu-btn-sim { background: #238636; color: #fff; }
    .qpu-btn-sim:hover { background: #2ea043; }
    .qpu-circuit-pre { flex: 1; overflow: auto; margin-top: 8px; padding: 10px; background: #161b22; border-radius: 6px; font-family: 'SF Mono', monospace; font-size: 0.625rem; line-height: 1.5; color: #7ee787; white-space: pre-wrap; min-height: 100px; max-height: 250px; }
    .qpu-canvas-wrap { flex: 1; position: relative; min-height: 200px; }
    .qpu-canvas-wrap canvas { position: absolute; inset: 0; width: 100%; height: 100%; }
    .qpu-status { font-size: 0.625rem; color: #8b949e; margin-top: 8px; font-family: 'SF Mono', monospace; }
    .qpu-fidelity { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 0.625rem; font-family: 'SF Mono', monospace; font-weight: 700; margin-left: 8px; }
    @media (max-width: 700px) { .qpu-section { grid-template-columns: 1fr; } }

    /* â”€â”€ Roadmap â”€â”€ */
    .roadmap { display: flex; flex-direction: column; gap: 0; position: relative; padding-left: 28px; }
    .roadmap::before { content: ''; position: absolute; left: 8px; top: 8px; bottom: 8px; width: 2px; background: #21262d; }
    .roadmap-item { position: relative; padding: 16px 0 16px 20px; }
    .roadmap-item::before { content: ''; position: absolute; left: -24px; top: 22px; width: 12px; height: 12px; border-radius: 50%; border: 2px solid; }
    .roadmap-item.done::before { background: #3fb950; border-color: #3fb950; }
    .roadmap-item.active::before { background: #58a6ff; border-color: #58a6ff; box-shadow: 0 0 8px rgba(88,166,255,0.5); }
    .roadmap-item.future::before { background: #0d1117; border-color: #484f58; }
    .roadmap-item h4 { font-size: 0.9375rem; font-weight: 700; margin-bottom: 4px; }
    .roadmap-item p { font-size: 0.8125rem; color: #8b949e; line-height: 1.5; }
    .roadmap-item .rm-tag { display: inline-block; font-size: 0.5625rem; font-family: 'SF Mono', monospace; padding: 2px 8px; border-radius: 999px; margin-top: 8px; }

    /* â”€â”€ Pipeline â”€â”€ */
    .pipeline { display: flex; align-items: center; gap: 0; flex-wrap: wrap; justify-content: center; }
    .pipe-step { background: #161b22; border: 1px solid #21262d; border-radius: 10px; padding: 16px 20px; text-align: center; min-width: 130px; transition: all 0.2s; }
    .pipe-step:hover { border-color: #30363d; transform: translateY(-2px); }
    .pipe-step .pipe-icon { font-size: 1.5rem; margin-bottom: 6px; }
    .pipe-step h5 { font-size: 0.75rem; font-weight: 700; margin-bottom: 2px; }
    .pipe-step p { font-size: 0.625rem; color: #8b949e; }
    .pipe-arrow { font-size: 1.25rem; color: #484f58; padding: 0 6px; }

    /* â”€â”€ Fade animation â”€â”€ */
    .fade-up { opacity: 0; transform: translateY(20px); transition: opacity 0.6s ease, transform 0.6s ease; }
    .fade-up.visible { opacity: 1; transform: translateY(0); }

    /* â”€â”€ Footer â”€â”€ */
    .footer { text-align: center; padding: 24px; font-size: 0.6875rem; color: #484f58; border-top: 1px solid #21262d; font-family: 'SF Mono', monospace; }

    /* â”€â”€ Responsive â”€â”€ */
    @media (max-width: 768px) {
        .live-editor { grid-template-columns: 1fr; }
        .canvas-trio { grid-template-columns: 1fr; }
        .sym-grid { grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); }
        .bench-grid { grid-template-columns: 1fr; }
        .pipeline { flex-direction: column; }
        .pipe-arrow { transform: rotate(90deg); }
    }
    @media (max-width: 600px) {
        .hero h1 { font-size: 2rem; letter-spacing: -1px; }
        .hero p { font-size: 0.9375rem; }
        section { padding: 60px 16px; }
        .stats-ribbon { gap: 20px; }
        .stat .number { font-size: 1.5rem; }
    }
</style>
</head>
<body>

<!-- â”â”â” Top Rainbow â”â”â” -->
<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>
<div class="rainbow-glow"></div>

<!-- â”â”â” Hero â”â”â” -->
<div class="hero">
    <canvas id="hero-canvas"></canvas>
    <div class="hero-content">
        <div class="hero-badge"><span class="dot"></span> 11 symbols &middot; 20 languages &middot; sub-microsecond</div>
        <h1>
            The <span class="gradient">Quantum Gutter</span>
        </h1>
        <div style="font-family:'SF Mono','Fira Code',monospace;font-size:clamp(0.75rem,1.8vw,1rem);color:#8b949e;margin-bottom:8px;letter-spacing:0.5px;">
            Quantum beyondBINARY notepad
        </div>
        <div style="font-family:'SF Mono','Fira Code',monospace;font-size:clamp(0.6875rem,1.5vw,0.875rem);color:#c9d1d9;margin-bottom:6px;">
            {<span style="color:#ff3838">+1</span>, <span style="color:#58a6ff">1</span>, <span style="color:#f0883e">-1</span>, <span style="color:#ffe138">+0</span>, <span style="color:#569cd6">0</span>, <span style="color:#484f58">-0</span>, <span style="color:#bc8cff">+n</span>, <span style="color:#3fb950">n</span>, <span style="color:#da3633">-n</span>}
        </div>
        <div style="display:flex;height:3px;width:min(280px,60%);margin:0 auto 12px;border-radius:2px;overflow:hidden;">
            <span style="flex:1;background:#ff3838"></span><span style="flex:1;background:#ff8c38"></span><span style="flex:1;background:#ffe138"></span><span style="flex:1;background:#3fb950"></span><span style="flex:1;background:#38a5ff"></span><span style="flex:1;background:#bc8cff"></span>
        </div>
        <p style="font-size:clamp(0.75rem,1.4vw,0.875rem);color:#6e7681;margin-bottom:24px;letter-spacing:0.3px;font-family:'SF Mono','Fira Code',monospace;">
            dimensional code addressing &middot; charm visual layer
        </p>
        <p>
            Every line of code has a structural identity. The beyondBINARY prefix system classifies
            it in real time â€” imports, loops, returns, I/O â€” using 11 symbols that work in 20+ languages.
        </p>
        <div class="hero-actions">
            <a class="btn btn-primary" href="quantum-notepad.html">Open Notepad</a>
            <a class="btn btn-secondary" href="https://github.com/fornevercollective/uvspeed" target="_blank">View Source</a>
        </div>
    </div>
</div>

<!-- â”â”â” Stats â”â”â” -->
<div class="stats-ribbon">
    <div class="stat"><div class="number" id="st-lines">0</div><div class="label">Lines / sec</div></div>
    <div class="stat"><div class="number">9</div><div class="label">Prefix Symbols</div></div>
    <div class="stat"><div class="number">20</div><div class="label">Languages</div></div>
    <div class="stat"><div class="number" id="st-coverage">0%</div><div class="label">Avg Coverage</div></div>
    <div class="stat"><div class="number">0</div><div class="label">Dependencies</div></div>
</div>

<!-- â”â”â” The 11 Symbols â”â”â” -->
<section>
    <h2 class="fade-up">The 11 symbols</h2>
    <p class="section-sub fade-up">Every line maps to exactly one prefix. No ambiguity. No configuration. Universal across all languages.</p>

    <!-- Interactive 3D prefix cube -->
    <div class="prefix-cube-wrap fade-up">
        <canvas class="prefix-cube-canvas" id="prefix-cube"></canvas>
        <div class="prefix-cube-hint">drag to rotate Â· scroll to zoom Â· hover for detail</div>
    </div>

    <div class="sym-grid fade-up" id="sym-grid"></div>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” Pipeline â”â”â” -->
<section>
    <h2 class="fade-up">Code â†’ Quantum Pipeline</h2>
    <p class="section-sub fade-up">From raw text to spatially-addressed, navigable, exportable code in 5 stages.</p>

    <div class="pipeline fade-up">
        <div class="pipe-step">
            <div class="pipe-icon">ðŸ“„</div>
            <h5>Raw Code</h5>
            <p>Any language, any file</p>
        </div>
        <div class="pipe-arrow">â†’</div>
        <div class="pipe-step">
            <div class="pipe-icon">ðŸ”¬</div>
            <h5>Classify</h5>
            <p>Regex â†’ category per line</p>
        </div>
        <div class="pipe-arrow">â†’</div>
        <div class="pipe-step">
            <div class="pipe-icon">âš›</div>
            <h5>Prefix</h5>
            <p>11-symbol structural tag</p>
        </div>
        <div class="pipe-arrow">â†’</div>
        <div class="pipe-step">
            <div class="pipe-icon">ðŸ§Š</div>
            <h5>Navigate</h5>
            <p>Slice / Cube / Orb views</p>
        </div>
        <div class="pipe-arrow">â†’</div>
        <div class="pipe-step">
            <div class="pipe-icon">ðŸ“¡</div>
            <h5>Broadcast</h5>
            <p>Cross-app sync + IoT</p>
        </div>
    </div>
</section>

<!-- â”â”â” Live Editor â”â”â” -->
<section>
    <h2 class="fade-up">Try it live</h2>
    <p class="section-sub fade-up">Edit the code on the left â€” watch the quantum gutter classify every line in real time.</p>

    <div class="live-editor fade-up">
        <div class="editor-pane">
            <div class="pane-header">
                <span>Source Code</span>
                <select class="lang-select" id="lang-select">
                    <option value="python">Python</option>
                    <option value="javascript">JavaScript</option>
                    <option value="typescript">TypeScript</option>
                    <option value="rust">Rust</option>
                    <option value="go">Go</option>
                    <option value="swift">Swift</option>
                    <option value="c">C</option>
                    <option value="shell">Shell</option>
                    <option value="ruby">Ruby</option>
                    <option value="html">HTML</option>
                    <option value="css">CSS</option>
                    <option value="sql">SQL</option>
                </select>
            </div>
            <textarea id="code-input" spellcheck="false">#!/usr/bin/env python3
# Quantum prefix classification engine
import numpy as np
from tinygrad.tensor import Tensor

class QuantumState:
    """Represents a quantum state vector."""

    def __init__(self, qubits=3):
        self.n = qubits
        self.state = Tensor.randn(2 ** qubits)

    def normalize(self):
        return self.state / self.state.norm()

    def measure(self):
        try:
            probs = (self.state ** 2).numpy()
            for i in range(len(probs)):
                if probs[i] > 0.5:
                    return i
            return probs
        except Exception as e:
            print(f"Measurement error: {e}")
            raise</textarea>
        </div>
        <div class="editor-pane">
            <div class="pane-header">
                <span>Quantum Gutter</span>
                <span id="gutter-stats" style="font-family:'SF Mono',monospace;font-size:0.625rem;color:#3fb950;"></span>
            </div>
            <div class="gutter-pane" id="gutter-output"></div>
        </div>
    </div>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” Benchmarks â”â”â” -->
<section>
    <h2 class="fade-up">Benchmark: classify pipeline</h2>
    <p class="section-sub fade-up">Real-time performance metrics from this browser. Click "Run" to re-benchmark.</p>

    <div style="margin-bottom:20px;" class="fade-up">
        <button class="btn btn-secondary" id="bench-run" style="font-size:0.8125rem;padding:8px 20px;">â–¶ Run Benchmarks</button>
    </div>

    <div class="bench-grid fade-up" id="bench-grid"></div>
</section>

<!-- â”â”â” Visual Showcase (Slice / Orb / Hex Stream) â”â”â” -->
<section>
    <h2 class="fade-up">Visualize the quantum space</h2>
    <p class="section-sub fade-up">Three ways to see code structure â€” each canvas is live and interactive.</p>

    <div class="canvas-trio fade-up">
        <div class="canvas-card">
            <canvas id="cv-slice" width="400" height="280"></canvas>
            <div class="cc-label"><span>ðŸ§Š Slice</span><span class="cc-tag">11Ã—11 prefix grid Â· click to navigate</span></div>
        </div>
        <div class="canvas-card">
            <canvas id="cv-orb" width="400" height="280"></canvas>
            <div class="cc-label"><span>ðŸ”® Orb</span><span class="cc-tag">120 particles Â· orbital density</span></div>
        </div>
        <div class="canvas-card">
            <canvas id="cv-hex" width="400" height="280"></canvas>
            <div class="cc-label"><span>â¬¡ Hex Stream</span><span class="cc-tag">live data flow Â· prefix-colored</span></div>
        </div>
    </div>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” Physical QPU Integration â”â”â” -->
<section>
    <h2 class="fade-up">Run on Real Quantum Hardware</h2>
    <p class="section-sub fade-up">Build a quantum circuit from the prefix classification of your code, then execute it on a local statevector simulator or IBM Quantum's 127-qubit Eagle processors (free tier: 10 min/month).</p>

    <div class="qpu-section fade-up">
        <div class="qpu-panel">
            <div class="qpu-controls">
                <div class="qpu-row">
                    <label>Token</label>
                    <input type="password" id="gutter-qpu-token" placeholder="IBM Quantum API token (quantum.ibm.com)">
                </div>
                <div class="qpu-row">
                    <label>Backend</label>
                    <select id="gutter-qpu-backend">
                        <option value="local">Local Simulator (instant)</option>
                        <option value="ibm_brisbane">ibm_brisbane (127q Eagle)</option>
                        <option value="ibm_kyoto">ibm_kyoto (127q Eagle)</option>
                        <option value="ibm_osaka">ibm_osaka (127q Eagle)</option>
                    </select>
                </div>
                <div class="qpu-row">
                    <label>Shots</label>
                    <input type="number" id="gutter-qpu-shots" value="1024" min="1" max="8192">
                </div>
                <div class="qpu-row" style="gap:6px;">
                    <button class="qpu-btn qpu-btn-sim" id="gutter-qpu-build">Build Circuit</button>
                    <button class="qpu-btn qpu-btn-run" id="gutter-qpu-run">&#9654; Run</button>
                </div>
            </div>
            <div class="qpu-circuit-pre" id="gutter-qpu-circuit">// Click "Build Circuit" to generate from the live editor above
// Or type code in the editor and build a quantum circuit from its prefix structure
//
// Each line's prefix maps to a quantum gate:
//   +1: â†’ H (Hadamard)    1: â†’ CNOT    -1: â†’ X
//   +0: â†’ Rz              0: â†’ I       -0: â†’ S
//   +n: â†’ T               n: â†’ SWAP    -n: â†’ M
//   +2: â†’ CZ              +3: â†’ Y</div>
            <div class="qpu-status" id="gutter-qpu-status">Ready</div>
        </div>
        <div class="qpu-panel">
            <div style="font-size:0.6875rem;font-weight:700;color:#a371f7;margin-bottom:8px;">Measurement Histogram <span class="qpu-fidelity" id="gutter-fidelity" style="display:none;"></span></div>
            <div class="qpu-canvas-wrap"><canvas id="cv-qpu-histogram"></canvas></div>
            <div class="qpu-status" id="gutter-qpu-result-info"></div>
        </div>
    </div>
</section>

<!-- â”â”â” Phase 6: Local Simulator Baseline â”â”â” -->
<section>
    <h2 class="fade-up">Phase 6: Local Simulator Baseline</h2>
    <p class="section-sub fade-up">Five real code samples â€” one per language â€” each classified by the 11-symbol prefix system, converted to a quantum circuit, and simulated with 1,024 measurement shots on the in-browser <code>QSim</code> statevector engine. These baselines are the reference distributions that IBM Quantum QPU results are compared against.</p>

    <!-- â”€â”€ Baseline metrics (measured) â”€â”€ -->
    <div style="overflow-x:auto;" class="fade-up">
    <table style="width:100%;border-collapse:collapse;font-size:0.75rem;font-family:'SF Mono',monospace;margin-top:12px;">
        <thead>
            <tr style="border-bottom:2px solid #30363d;color:#8b949e;">
                <th style="text-align:left;padding:8px 12px;">Language</th>
                <th style="text-align:center;padding:8px;">Qubits</th>
                <th style="text-align:center;padding:8px;">Gates</th>
                <th style="text-align:center;padding:8px;">States</th>
                <th style="text-align:center;padding:8px;">Coverage</th>
                <th style="text-align:center;padding:8px;">Top State</th>
                <th style="text-align:center;padding:8px;">Sim Time</th>
            </tr>
        </thead>
        <tbody>
            <tr style="border-bottom:1px solid #21262d;">
                <td style="padding:8px 12px;color:#3572A5;font-weight:600;">Python</td>
                <td style="text-align:center;padding:8px;">2</td>
                <td style="text-align:center;">21</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;color:#3fb950;">67%</td>
                <td style="text-align:center;"><code style="color:#7ee787;">|00&#10217;</code> 50.8%</td>
                <td style="text-align:center;color:#8b949e;">1 ms</td>
            </tr>
            <tr style="border-bottom:1px solid #21262d;">
                <td style="padding:8px 12px;color:#f1e05a;font-weight:600;">JavaScript</td>
                <td style="text-align:center;padding:8px;">5</td>
                <td style="text-align:center;">28</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;color:#d4a017;">39%</td>
                <td style="text-align:center;"><code style="color:#7ee787;">|00101&#10217;</code> 51.5%</td>
                <td style="text-align:center;color:#8b949e;">2 ms</td>
            </tr>
            <tr style="border-bottom:1px solid #21262d;">
                <td style="padding:8px 12px;color:#dea584;font-weight:600;">Rust</td>
                <td style="text-align:center;padding:8px;">3</td>
                <td style="text-align:center;">27</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;color:#d4a017;">37%</td>
                <td style="text-align:center;"><code style="color:#7ee787;">|010&#10217;</code> 52.1%</td>
                <td style="text-align:center;color:#8b949e;">4 ms</td>
            </tr>
            <tr style="border-bottom:1px solid #21262d;">
                <td style="padding:8px 12px;color:#e34c26;font-weight:600;">HTML</td>
                <td style="text-align:center;padding:8px;">2</td>
                <td style="text-align:center;">22</td>
                <td style="text-align:center;">1</td>
                <td style="text-align:center;color:#f85149;">18%</td>
                <td style="text-align:center;"><code style="color:#7ee787;">|00&#10217;</code> 100%</td>
                <td style="text-align:center;color:#8b949e;">1 ms</td>
            </tr>
            <tr style="border-bottom:1px solid #21262d;">
                <td style="padding:8px 12px;color:#89e051;font-weight:600;">Shell</td>
                <td style="text-align:center;padding:8px;">4</td>
                <td style="text-align:center;">25</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;color:#3fb950;">60%</td>
                <td style="text-align:center;"><code style="color:#7ee787;">|0001&#10217;</code> 52.6%</td>
                <td style="text-align:center;color:#8b949e;">1 ms</td>
            </tr>
        </tbody>
        <tfoot>
            <tr style="border-top:2px solid #30363d;font-weight:700;">
                <td style="padding:8px 12px;color:#a371f7;">Average</td>
                <td style="text-align:center;padding:8px;">3.2</td>
                <td style="text-align:center;">25</td>
                <td style="text-align:center;">2</td>
                <td style="text-align:center;color:#d4a017;">44%</td>
                <td style="text-align:center;color:#8b949e;">â€”</td>
                <td style="text-align:center;color:#3fb950;">1.8 ms</td>
            </tr>
        </tfoot>
    </table>
    </div>

    <!-- â”€â”€ Self-fidelity â”€â”€ -->
    <div style="margin-top:16px;padding:12px 16px;background:#161b22;border:1px solid #21262d;border-radius:8px;font-size:0.75rem;font-family:'SF Mono',monospace;" class="fade-up">
        <div style="color:#a371f7;font-weight:700;margin-bottom:8px;">Self-Fidelity Check</div>
        <div style="color:#c9d1d9;">Python sample, two independent runs of 2,048 shots each:</div>
        <div style="color:#3fb950;font-size:1rem;font-weight:700;margin:6px 0;">99.96% Hellinger fidelity</div>
        <div style="color:#8b949e;">Confirms the QSim statevector engine produces consistent, deterministic baselines suitable for QPU comparison.</div>
    </div>

    <!-- â”€â”€ Cross-language fidelity matrix â”€â”€ -->
    <div style="margin-top:16px;" class="fade-up">
        <div style="font-size:0.75rem;font-weight:700;color:#a371f7;margin-bottom:8px;">Cross-Language Hellinger Fidelity Matrix</div>
        <div style="overflow-x:auto;">
        <table style="border-collapse:collapse;font-size:0.6875rem;font-family:'SF Mono',monospace;">
            <thead>
                <tr><th style="padding:4px 10px;"></th><th style="padding:4px 10px;color:#3572A5;">Python</th><th style="padding:4px 10px;color:#f1e05a;">JS</th><th style="padding:4px 10px;color:#dea584;">Rust</th><th style="padding:4px 10px;color:#e34c26;">HTML</th><th style="padding:4px 10px;color:#89e051;">Shell</th></tr>
            </thead>
            <tbody>
                <tr><td style="padding:4px 10px;color:#3572A5;font-weight:600;">Python</td><td style="text-align:center;padding:4px 10px;color:#3fb950;font-weight:700;">100%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#d4a017;">51%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td></tr>
                <tr><td style="padding:4px 10px;color:#f1e05a;font-weight:600;">JS</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#3fb950;font-weight:700;">100%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td></tr>
                <tr><td style="padding:4px 10px;color:#dea584;font-weight:600;">Rust</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#3fb950;font-weight:700;">100%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td></tr>
                <tr><td style="padding:4px 10px;color:#e34c26;font-weight:600;">HTML</td><td style="text-align:center;padding:4px 10px;color:#d4a017;">51%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#3fb950;font-weight:700;">100%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td></tr>
                <tr><td style="padding:4px 10px;color:#89e051;font-weight:600;">Shell</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#f85149;">0%</td><td style="text-align:center;padding:4px 10px;color:#3fb950;font-weight:700;">100%</td></tr>
            </tbody>
        </table>
        </div>
        <p style="font-size:0.6875rem;color:#8b949e;margin-top:8px;line-height:1.5;">Each language produces a unique quantum fingerprint. The 0% cross-language fidelity confirms that different prefix distributions map to structurally distinct circuits â€” a Python class hierarchy and a Bash pipeline occupy completely different regions of Hilbert space. The 51% overlap between Python and HTML comes from both having many unclassified lines that map to identity gates, collapsing amplitude into the same <code>|00&#10217;</code> ground state.</p>
    </div>

    <!-- â”€â”€ kbatch connection â”€â”€ -->
    <div style="margin-top:20px;padding:16px;background:#161b22;border:1px solid #30363d;border-radius:10px;" class="fade-up">
        <div style="font-size:0.875rem;font-weight:700;color:#c9d1d9;margin-bottom:10px;">How kbatch feeds the quantum pipeline</div>
        <p style="font-size:0.75rem;color:#8b949e;line-height:1.7;margin-bottom:12px;">
            <a href="kbatch.html" style="color:#58a6ff;text-decoration:none;font-weight:600;">kbatch</a> is the world keyboard analyzer â€” 15 international layouts, IBM Quantum bridge, dictionary lookups, and typing drills â€” all in a single HTML file. Its Quantum tab is where the bridge was born: typing patterns get converted to quantum gates (key transitions become rotation angles, finger movements become entanglement), and circuits are submitted to IBM's 127-qubit Eagle processors on the free developer tier.
        </p>
        <p style="font-size:0.75rem;color:#8b949e;line-height:1.7;margin-bottom:12px;">
            That same <code>QuantumBridge</code> logic has now been promoted into the shared <code>quantum-prefixes.js</code> module as <code>QuantumPrefixes.QSim</code> and <code>QuantumPrefixes.submitToIBM()</code>. Every app in uvspeed can now generate and run quantum circuits â€” kbatch does it from keyboard data, this page does it from code prefix structure, and notepad does it from notebook cells.
        </p>

        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:8px;margin-top:12px;">
            <div style="background:#0d1117;border:1px solid #21262d;border-radius:6px;padding:10px;text-align:center;">
                <div style="font-size:1.25rem;">âŒ¨</div>
                <div style="font-size:0.6875rem;font-weight:700;color:#c9d1d9;margin:4px 0;">kbatch</div>
                <div style="font-size:0.5625rem;color:#8b949e;">Typing patterns â†’ gates<br>15 layouts Ã— 10 min IBM</div>
            </div>
            <div style="background:#0d1117;border:1px solid #21262d;border-radius:6px;padding:10px;text-align:center;">
                <div style="font-size:1.25rem;">âš›</div>
                <div style="font-size:0.6875rem;font-weight:700;color:#c9d1d9;margin:4px 0;">quantum-gutter</div>
                <div style="font-size:0.5625rem;color:#8b949e;">Code prefixes â†’ gates<br>5-lang calibration bench</div>
            </div>
            <div style="background:#0d1117;border:1px solid #21262d;border-radius:6px;padding:10px;text-align:center;">
                <div style="font-size:1.25rem;">ðŸ““</div>
                <div style="font-size:0.6875rem;font-weight:700;color:#c9d1d9;margin:4px 0;">quantum-notepad</div>
                <div style="font-size:0.5625rem;color:#8b949e;">Notebook cells â†’ gates<br>PWA export with prefixes</div>
            </div>
            <div style="background:#0d1117;border:1px solid #21262d;border-radius:6px;padding:10px;text-align:center;">
                <div style="font-size:1.25rem;">ðŸ”—</div>
                <div style="font-size:0.6875rem;font-weight:700;color:#c9d1d9;margin:4px 0;">quantum-prefixes.js</div>
                <div style="font-size:0.5625rem;color:#8b949e;">Shared module<br>QSim + submitToIBM + fidelity</div>
            </div>
        </div>
    </div>

    <!-- â”€â”€ Analysis â”€â”€ -->
    <div style="margin-top:16px;padding:12px 16px;background:rgba(137,86,229,0.05);border:1px solid rgba(137,86,229,0.2);border-radius:8px;font-size:0.75rem;line-height:1.7;color:#c9d1d9;" class="fade-up">
        <div style="font-weight:700;color:#a371f7;margin-bottom:6px;">Analysis: What the baselines tell us</div>
        <p><strong>Low state counts (1-2)</strong> â€” The circuits are shallow (prefix-driven, not deeply entangled). Most amplitude concentrates in a few basis states. This is favorable for QPU comparison because shallow circuits are less sensitive to decoherence noise on real hardware.</p>
        <p style="margin-top:8px;"><strong>Coverage drives circuit richness</strong> â€” Python (67%) and Shell (60%) produce 2-state superpositions with near-even splits. HTML (18% coverage) collapses entirely to <code>|00&#10217;</code> because most lines are unclassified, mapping to identity gates that preserve the initial state. Higher prefix coverage = more interesting quantum behavior.</p>
        <p style="margin-top:8px;"><strong>IBM QPU expectations</strong> â€” On <code>ibm_brisbane</code> (127-qubit Eagle), we expect 70-95% Hellinger fidelity for these 2-5 qubit circuits. The free tier gives 10 minutes/month of execution â€” enough to run all 5 calibration circuits multiple times and track fidelity trends across backend calibration cycles.</p>
    </div>

    <!-- â”€â”€ Interactive calibration table (live) â”€â”€ -->
    <div style="margin-top:20px;" class="fade-up">
        <div style="font-size:0.75rem;font-weight:700;color:#a371f7;margin-bottom:8px;">Live Calibration (click to re-run with your browser)</div>
    </div>

    <div style="overflow-x:auto;" class="fade-up">
    <table style="width:100%;border-collapse:collapse;font-size:0.75rem;font-family:'SF Mono',monospace;margin-top:4px;">
        <thead>
            <tr style="border-bottom:1px solid #30363d;color:#8b949e;">
                <th style="text-align:left;padding:8px;">Language</th>
                <th style="text-align:center;padding:8px;">Qubits</th>
                <th style="text-align:center;padding:8px;">Gates</th>
                <th style="text-align:center;padding:8px;">Local States</th>
                <th style="text-align:center;padding:8px;">QPU States</th>
                <th style="text-align:center;padding:8px;">Fidelity</th>
                <th style="text-align:center;padding:8px;">Status</th>
            </tr>
        </thead>
        <tbody id="calib-table-body">
            <tr id="calib-python"><td style="padding:8px;color:#3572A5;">Python</td><td style="text-align:center;padding:8px;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;color:#484f58;">Ready</td></tr>
            <tr id="calib-javascript"><td style="padding:8px;color:#f1e05a;">JavaScript</td><td style="text-align:center;padding:8px;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;color:#484f58;">Ready</td></tr>
            <tr id="calib-rust"><td style="padding:8px;color:#dea584;">Rust</td><td style="text-align:center;padding:8px;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;color:#484f58;">Ready</td></tr>
            <tr id="calib-html"><td style="padding:8px;color:#e34c26;">HTML</td><td style="text-align:center;padding:8px;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;color:#484f58;">Ready</td></tr>
            <tr id="calib-shell"><td style="padding:8px;color:#89e051;">Shell</td><td style="text-align:center;padding:8px;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;">â€”</td><td style="text-align:center;color:#484f58;">Ready</td></tr>
        </tbody>
        <tfoot>
            <tr style="border-top:1px solid #30363d;font-weight:700;">
                <td style="padding:8px;color:#a371f7;">Average</td>
                <td colspan="4" style="text-align:center;padding:8px;" id="calib-avg-info">â€”</td>
                <td style="text-align:center;padding:8px;" id="calib-avg-fidelity">â€”</td>
                <td style="text-align:center;padding:8px;" id="calib-avg-status">â€”</td>
            </tr>
        </tfoot>
    </table>
    </div>

    <div style="display:flex;gap:8px;margin-top:12px;" class="fade-up">
        <button class="qpu-btn qpu-btn-sim" id="calib-run-local" style="flex:1;">Run Local Calibration (5 circuits &times; 1024 shots)</button>
        <button class="qpu-btn qpu-btn-run" id="calib-run-ibm" style="flex:1;">Compare on IBM QPU (requires token above)</button>
    </div>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” Language Coverage â”â”â” -->
<section>
    <h2 class="fade-up">20-language coverage</h2>
    <p class="section-sub fade-up">Classification accuracy measured against hand-labeled corpora. Same 11 symbols, every language.</p>

    <div class="cov-chart fade-up" id="cov-chart"></div>
</section>

<!-- â”â”â” Architecture: Prefixes as Hardware Data Flow â”â”â” -->
<section>
    <h2 class="fade-up">Prefix â†” Hardware Data Flow</h2>
    <p class="section-sub fade-up">Each quantum prefix maps to a stage in the GPU/CPU compute pipeline. Code isn't just text â€” it has a physical address in silicon.</p>

    <div class="arch-flow-section fade-up">
        <div class="arch-flow-title">
            NVIDIA Blackwell Ultra SM Architecture
            <span class="af-chip" style="background:rgba(63,185,80,0.15);color:#3fb950;">Live in Blackwell App</span>
        </div>
        <div class="arch-stack">
            <div class="arch-layer" style="border-left: 3px solid #ff5757;">
                <span class="al-prefix" style="color:#ff5757;">n:</span>
                <span class="al-hw">Instruction Cache</span>
                <span class="al-desc">Entry points, shebangs â€” first bytes fetched from L1i cache into the warp scheduler. Where code execution begins on-chip.</span>
                <span class="al-stat">128 KB L1i</span>
            </div>
            <div class="arch-flow-arrow">&#8595; fetch &#8595;</div>
            <div class="arch-layer" style="border-left: 3px solid #f0883e;">
                <span class="al-prefix" style="color:#f0883e;">+n:</span>
                <span class="al-hw">Warp Schedulers</span>
                <span class="al-desc">Conditionals, if/else/switch â€” branch divergence resolved here. 4 schedulers per SM dispatch 128 threads to execution units.</span>
                <span class="al-stat">4 sched / SM</span>
            </div>
            <div class="arch-flow-arrow">&#8595; dispatch &#8595;</div>
            <div class="arch-layer" style="border-left: 3px solid #3fb950;">
                <span class="al-prefix" style="color:#3fb950;">1:</span>
                <span class="al-hw">Register File</span>
                <span class="al-desc">Variable declarations â€” 256 KB register file per SM holds all thread-local state. The fastest memory on the chip (0-cycle latency).</span>
                <span class="al-stat">256 KB / SM</span>
            </div>
            <div class="arch-flow-arrow">&#8595; operands &#8595;</div>
            <div class="arch-layer" style="border-left: 3px solid #58a6ff;">
                <span class="al-prefix" style="color:#58a6ff;">0:</span>
                <span class="al-hw">Processing Cores</span>
                <span class="al-desc">Function/method bodies â€” INT32, FP32, FP64, Tensor Core 5th-gen units. This is where compute happens. 128 FP32 cores per SM.</span>
                <span class="al-stat">128 FP32 / SM</span>
            </div>
            <div class="arch-flow-arrow">&#8595; execute &#8595;</div>
            <div class="arch-layer" style="border-left: 3px solid #a78bfa;">
                <span class="al-prefix" style="color:#a78bfa;">-n:</span>
                <span class="al-hw">Load/Store + SFU</span>
                <span class="al-desc">Imports, data loading â€” LD/ST units fetch from memory hierarchy. 32 LD/ST units + 32 SFU for transcendentals (sin, cos, exp).</span>
                <span class="al-stat">32 LD/ST units</span>
            </div>
            <div class="arch-flow-arrow">&#8595; data &#8595;</div>
            <div class="arch-layer" style="border-left: 3px solid #e2498a;">
                <span class="al-prefix" style="color:#e2498a;">-0:</span>
                <span class="al-hw">L1 Cache / Shared Mem</span>
                <span class="al-desc">Return/yield â€” results staged in 128 KB configurable L1/shared memory. Hot data stays on-SM. Return values live here before writeback.</span>
                <span class="al-stat">128 KB L1</span>
            </div>
            <div class="arch-flow-arrow">&#8595; writeback &#8595;</div>
            <div class="arch-layer" style="border-left: 3px solid #d4a017;">
                <span class="al-prefix" style="color:#d4a017;">+3:</span>
                <span class="al-hw">L2 / HBM3e / NVLink</span>
                <span class="al-desc">Output, print, render â€” final results flow to 64 MB L2 cache, 288 GB HBM3e (8 TB/s), or NVLink 5 (1.8 TB/s) to other GPUs.</span>
                <span class="al-stat">288 GB HBM3e</span>
            </div>
        </div>

        <div class="arch-stats-row">
            <div class="arch-stat-card">
                <div class="as-val" style="color:#3fb950;">192</div>
                <div class="as-lbl">SMs per B200</div>
            </div>
            <div class="arch-stat-card">
                <div class="as-val" style="color:#58a6ff;">2.5</div>
                <div class="as-lbl">PetaFLOPS FP4 AI</div>
            </div>
            <div class="arch-stat-card">
                <div class="as-val" style="color:#a78bfa;">8</div>
                <div class="as-lbl">TB/s HBM Bandwidth</div>
            </div>
            <div class="arch-stat-card">
                <div class="as-val" style="color:#e2498a;">1.8</div>
                <div class="as-lbl">TB/s NVLink 5</div>
            </div>
            <div class="arch-stat-card">
                <div class="as-val" style="color:#f0883e;">9</div>
                <div class="as-lbl">Prefix Symbols</div>
            </div>
        </div>
    </div>

    <p class="fade-up" style="font-size:0.8125rem;color:#8b949e;margin-top:12px;">
        <strong style="color:#e6edf3;">Why this matters:</strong> When you classify a line as <code>0:</code> (function), you're implicitly identifying code that will execute on FP32/Tensor cores.
        A <code>1:</code> (variable) lives in the register file. A <code>-n:</code> (import) triggers load/store traffic.
        The quantum prefix isn't just a label â€” it's a <em>physical address in the compute pipeline</em>.
        Profiling tools like Perfetto, NSight, and our Blackwell app can correlate prefix distributions with actual hardware utilization.
    </p>
    <p class="fade-up" style="font-size:0.8125rem;color:#8b949e;margin-top:8px;">
        <strong style="color:#e6edf3;">Quantum Circuit Bridge (v4.3):</strong> Every prefix now maps to a quantum gate via <code>QuantumPrefixes.toQuantumCircuit(code, lang)</code>.
        11 gates total: H, CNOT, X, Rz, I, S, T, SWAP, M + CZ (loops) + Y (output).
        The circuit can be relayed to a QPU via <code>sendToQPU()</code> over the IoT WebSocket bridge.
        Code structure becomes a quantum circuit â€” the gutter is the circuit diagram.
    </p>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” Multi-Manufacturer Architecture Expansion â”â”â” -->
<section>
    <h2 class="fade-up">Multi-Architecture Expansion</h2>
    <p class="section-sub fade-up">Same 9 prefixes, mapped to every major compute architecture. The data flow is universal â€” only the layer names change.</p>

    <div class="mfg-grid fade-up">
        <div class="mfg-card">
            <h4><span style="color:#76b900;">&#9632;</span> NVIDIA Blackwell</h4>
            <div class="mfg-sub">B200 / GB200 â€” 192 SMs, 4nm, 2.5 PFLOPS FP4</div>
            <ul class="mfg-layers">
                <li><span class="mfg-pre" style="color:#ff5757;">n:</span> Instruction Cache (128 KB L1i)</li>
                <li><span class="mfg-pre" style="color:#f0883e;">+n:</span> 4Ã— Warp Schedulers (128 threads/warp)</li>
                <li><span class="mfg-pre" style="color:#3fb950;">1:</span> Register File (256 KB/SM)</li>
                <li><span class="mfg-pre" style="color:#58a6ff;">0:</span> 128 FP32 + Tensor Core 5G</li>
                <li><span class="mfg-pre" style="color:#a78bfa;">-n:</span> 32 LD/ST + 32 SFU</li>
                <li><span class="mfg-pre" style="color:#e2498a;">-0:</span> 128 KB L1/Shared</li>
                <li><span class="mfg-pre" style="color:#d4a017;">+3:</span> 64 MB L2 â†’ 288 GB HBM3e</li>
            </ul>
            <span class="mfg-phase" style="background:rgba(63,185,80,0.15);color:#3fb950;">Phase 1 â€” Shipped</span>
        </div>

        <div class="mfg-card">
            <h4><span style="color:#ed1c24;">&#9632;</span> AMD CDNA 4 (MI350X)</h4>
            <div class="mfg-sub">Instinct MI350X â€” 288 CUs, 3nm, 2.3 PFLOPS FP4</div>
            <ul class="mfg-layers">
                <li><span class="mfg-pre" style="color:#ff5757;">n:</span> Instruction Buffer</li>
                <li><span class="mfg-pre" style="color:#f0883e;">+n:</span> Wavefront Scheduler (64 threads/wave)</li>
                <li><span class="mfg-pre" style="color:#3fb950;">1:</span> Vector Register File (256 KB/CU)</li>
                <li><span class="mfg-pre" style="color:#58a6ff;">0:</span> 128 VALU + Matrix Core 2G</li>
                <li><span class="mfg-pre" style="color:#a78bfa;">-n:</span> Scalar Unit + LD/ST</li>
                <li><span class="mfg-pre" style="color:#e2498a;">-0:</span> 32 KB L1 + 64 KB LDS</li>
                <li><span class="mfg-pre" style="color:#d4a017;">+3:</span> 256 MB Infinity Cache â†’ 288 GB HBM3e</li>
            </ul>
            <span class="mfg-phase" style="background:rgba(88,166,255,0.15);color:#58a6ff;">Phase 2 â€” Q3 2026</span>
        </div>

        <div class="mfg-card">
            <h4><span style="color:#0071c5;">&#9632;</span> Intel Xe3 (Battlemage)</h4>
            <div class="mfg-sub">Arc B-series â€” 20 Xe-cores, Intel 4, 12 TFLOPS FP32</div>
            <ul class="mfg-layers">
                <li><span class="mfg-pre" style="color:#ff5757;">n:</span> Thread Dispatcher</li>
                <li><span class="mfg-pre" style="color:#f0883e;">+n:</span> EU Thread Arbiter (8 threads/EU)</li>
                <li><span class="mfg-pre" style="color:#3fb950;">1:</span> GRF (128 Ã— 32B per EU)</li>
                <li><span class="mfg-pre" style="color:#58a6ff;">0:</span> 128 ALUs + XMX Engines</li>
                <li><span class="mfg-pre" style="color:#a78bfa;">-n:</span> Data Port + SLM gateway</li>
                <li><span class="mfg-pre" style="color:#e2498a;">-0:</span> 192 KB SLM per Xe-core</li>
                <li><span class="mfg-pre" style="color:#d4a017;">+3:</span> 16 MB L2 â†’ 12 GB GDDR6</li>
            </ul>
            <span class="mfg-phase" style="background:rgba(88,166,255,0.15);color:#58a6ff;">Phase 2 â€” Q3 2026</span>
        </div>

        <div class="mfg-card">
            <h4><span style="color:#a2aaad;">&#9632;</span> Apple M4 Ultra GPU</h4>
            <div class="mfg-sub">80 GPU cores, 3nm, Neural Engine 38 TOPS</div>
            <ul class="mfg-layers">
                <li><span class="mfg-pre" style="color:#ff5757;">n:</span> Tile Dispatch / Vertex Fetch</li>
                <li><span class="mfg-pre" style="color:#f0883e;">+n:</span> SIMD Group Controller</li>
                <li><span class="mfg-pre" style="color:#3fb950;">1:</span> Thread Registers (per SIMD lane)</li>
                <li><span class="mfg-pre" style="color:#58a6ff;">0:</span> ALU + FP16/FP32 Execution</li>
                <li><span class="mfg-pre" style="color:#a78bfa;">-n:</span> Tile Memory / Imageblock</li>
                <li><span class="mfg-pre" style="color:#e2498a;">-0:</span> Threadgroup Memory (32 KB)</li>
                <li><span class="mfg-pre" style="color:#d4a017;">+3:</span> System Level Cache â†’ 192 GB Unified</li>
            </ul>
            <span class="mfg-phase" style="background:rgba(72,79,88,0.3);color:#8b949e;">Phase 3 â€” 2027</span>
        </div>

        <div class="mfg-card">
            <h4><span style="color:#f7a41d;">&#9632;</span> Qualcomm Adreno (Snapdragon X)</h4>
            <div class="mfg-sub">Adreno X1-85 â€” 4nm, 4.6 TFLOPS, Mobile/Quest</div>
            <ul class="mfg-layers">
                <li><span class="mfg-pre" style="color:#ff5757;">n:</span> Command Processor</li>
                <li><span class="mfg-pre" style="color:#f0883e;">+n:</span> Wave Manager (128 threads/wave)</li>
                <li><span class="mfg-pre" style="color:#3fb950;">1:</span> Unified Shader Registers</li>
                <li><span class="mfg-pre" style="color:#58a6ff;">0:</span> SP Ã— ALU / Tensor Pipes</li>
                <li><span class="mfg-pre" style="color:#a78bfa;">-n:</span> UCHE Load/Store</li>
                <li><span class="mfg-pre" style="color:#e2498a;">-0:</span> GMEM (Tile Memory)</li>
                <li><span class="mfg-pre" style="color:#d4a017;">+3:</span> System Cache â†’ LPDDR5X</li>
            </ul>
            <span class="mfg-phase" style="background:rgba(72,79,88,0.3);color:#8b949e;">Phase 3 â€” 2027</span>
        </div>

        <div class="mfg-card">
            <h4><span style="color:#06b6d4;">&#9632;</span> QPU (Quantum Processor)</h4>
            <div class="mfg-sub">Superconducting / trapped-ion â€” 11 prefixâ†’gate mappings via <code>toQuantumCircuit()</code></div>
            <ul class="mfg-layers">
                <li><span class="mfg-pre" style="color:#6a9955;">+1:</span> H (Hadamard) â€” declaration â†’ superposition</li>
                <li><span class="mfg-pre" style="color:#d4d4d4;">1:</span> CNOT â€” logic branches entangle states</li>
                <li><span class="mfg-pre" style="color:#f44747;">-1:</span> X (Pauli-X) â€” I/O flips classical bit</li>
                <li><span class="mfg-pre" style="color:#4ec9b0;">+0:</span> Rz(Ï€/4) â€” assignment rotates phase</li>
                <li><span class="mfg-pre" style="color:#569cd6;">0:</span> I (Identity) â€” neutral / no-op</li>
                <li><span class="mfg-pre" style="color:#c586c0;">-0:</span> S (Phase) â€” comment metadata phase</li>
                <li><span class="mfg-pre" style="color:#d7ba7d;">+n:</span> T-gate â€” modifier precision</li>
                <li><span class="mfg-pre" style="color:#e2b714;">n:</span> SWAP â€” import moves data between qubits</li>
                <li><span class="mfg-pre" style="color:#a78bfa;">-n:</span> M (Measure) â€” unknown collapses state</li>
                <li><span class="mfg-pre" style="color:#9cdcfe;">+2:</span> CZ (Ctrl-Z) â€” loop iteration entanglement</li>
                <li><span class="mfg-pre" style="color:#ce9178;">+3:</span> Y (Pauli-Y) â€” output rotates observable</li>
            </ul>
            <span class="mfg-phase" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
    </div>

    <p class="fade-up" style="font-size:0.8125rem;color:#8b949e;">
        <strong style="color:#e6edf3;">Phase Plan:</strong>
        <strong>Phase 1</strong> (<span style="color:#3fb950;">Shipped</span>) â€” NVIDIA Blackwell SM as interactive layer stack. Live in Blackwell app with click-to-swap architecture selector.
        <strong>Phase 2</strong> (<span style="color:#3fb950;">Shipped v4.3</span>) â€” AMD CDNA 4 CU + Intel Xe3 core layer views. Same stack UI, swappable architecture definitions.
        <strong>Phase 3</strong> (<span style="color:#3fb950;">Shipped v4.3</span>) â€” Apple M4 Ultra Tile-based + Qualcomm Adreno X1 mobile pipeline. Enables Meta Quest / mobile profiling.
        <strong>Phase 4</strong> (<span style="color:#3fb950;">Shipped v4.3</span>) â€” QPU quantum gate mapping. 11 prefixâ†’gate mappings via <code>toQuantumCircuit()</code>. <code>sendToQPU()</code> bridge to physical hardware.
        All phases share the same prefix system â€” only the hardware layer names change.
    </p>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” Game Blocks Builder + PWA Pipeline â”â”â” -->
<section>
    <h2 class="fade-up">Game Blocks â†’ PWA Pipeline</h2>
    <p class="section-sub fade-up">From visual blocks to a deployed PWA app â€” a collaborative, AI-assisted development workflow built on the prefix system.</p>

    <div class="arch-flow-section fade-up" style="border-color:#f0883e44;">
        <div class="arch-flow-title">
            Game Blocks Builder
            <span class="af-chip" style="background:rgba(240,136,62,0.15);color:#f0883e;">Live in brotherNumsy</span>
        </div>
        <p style="font-size:0.8125rem;color:#8b949e;margin-bottom:16px;">
            24 block types across 8 categories â€” each block maps to a quantum prefix.
            Drag blocks onto a canvas, connect data flow, tweak parameters, and export to injectable JavaScript.
            The block graph <em>is</em> the quantum gutter in visual form.
            <br><strong style="color:#e6edf3;">v4.3:</strong> Blocks now generate real executable code (gravity, speed, spawn rates).
            Neural network agent (<code>nn_simple</code>) trains on gameplay with online weight updates.
            <code>numsyAI.train(episodes)</code> runs automated training sessions.
        </p>
        <div class="arch-stack">
            <div class="arch-layer" style="border-left:3px solid #3fb950;">
                <span class="al-prefix" style="color:#3fb950;">1:</span>
                <span class="al-hw">Entity</span>
                <span class="al-desc">Player, Companion, Enemy, Collectible â€” game objects with tweakable properties</span>
                <span class="al-stat">4 blocks</span>
            </div>
            <div class="arch-layer" style="border-left:3px solid #58a6ff;">
                <span class="al-prefix" style="color:#58a6ff;">0:</span>
                <span class="al-hw">Physics</span>
                <span class="al-desc">Gravity, Collision, Bounds, Velocity â€” simulation rules</span>
                <span class="al-stat">4 blocks</span>
            </div>
            <div class="arch-layer" style="border-left:3px solid #a78bfa;">
                <span class="al-prefix" style="color:#a78bfa;">+3:</span>
                <span class="al-hw">Visual</span>
                <span class="al-desc">Sprite, Particles, Parallax, HUD â€” rendering output</span>
                <span class="al-stat">4 blocks</span>
            </div>
            <div class="arch-layer" style="border-left:3px solid #f0883e;">
                <span class="al-prefix" style="color:#f0883e;">+n:</span>
                <span class="al-hw">Logic</span>
                <span class="al-desc">If Condition, On Event, Random â€” branching decisions</span>
                <span class="al-stat">3 blocks</span>
            </div>
            <div class="arch-layer" style="border-left:3px solid #e2498a;">
                <span class="al-prefix" style="color:#e2498a;">+2:</span>
                <span class="al-hw">Loop</span>
                <span class="al-desc">Game Loop, Spawn Wave, Repeat â€” iteration</span>
                <span class="al-stat">3 blocks</span>
            </div>
            <div class="arch-layer" style="border-left:3px solid #06b6d4;">
                <span class="al-prefix" style="color:#06b6d4;">-n:</span>
                <span class="al-hw">AI</span>
                <span class="al-desc">AI Behavior, Difficulty Scaling â€” learning &amp; adaptation</span>
                <span class="al-stat">2 blocks</span>
            </div>
            <div class="arch-layer" style="border-left:3px solid #ff5757;">
                <span class="al-prefix" style="color:#ff5757;">-1:</span>
                <span class="al-hw">Error</span>
                <span class="al-desc">Damage, Game Over â€” failure states and recovery</span>
                <span class="al-stat">2 blocks</span>
            </div>
            <div class="arch-layer" style="border-left:3px solid #d4a017;">
                <span class="al-prefix" style="color:#d4a017;">-0:</span>
                <span class="al-hw">Output</span>
                <span class="al-desc">Score Rule â€” result calculation and display</span>
                <span class="al-stat">2 blocks</span>
            </div>
        </div>
    </div>

    <h3 class="fade-up" style="font-size:1.125rem;font-weight:700;margin-bottom:16px;">Concept â†’ PWA: The Distributed Build Pipeline</h3>

    <div class="pwa-pipeline fade-up">
        <div class="pwa-stage">
            <div class="ps-num" style="color:#3fb950;">01</div>
            <div class="ps-body">
                <h4>Concept (Blocks)</h4>
                <p>Drag blocks onto a canvas to define game/app structure. Each block is prefix-tagged. AI or human â€” same visual language. Export produces quantum-prefixed JavaScript.</p>
                <div class="ps-tags">
                    <span class="ps-tag">brotherNumsy</span>
                    <span class="ps-tag">HexBench Pybricks</span>
                    <span class="ps-tag">24 block types</span>
                </div>
            </div>
        </div>
        <div class="pwa-stage">
            <div class="ps-num" style="color:#58a6ff;">02</div>
            <div class="ps-body">
                <h4>Code Generation (Notepad Cell)</h4>
                <p>Blocks export to a Quantum Notepad code cell. AI refines, fills in sprite data, adds edge cases. Every line gets its prefix. Prefix coverage = code completeness metric.</p>
                <div class="ps-tags">
                    <span class="ps-tag">quantum-notepad</span>
                    <span class="ps-tag">AI code gen</span>
                    <span class="ps-tag">prefix coverage 95%+</span>
                </div>
            </div>
        </div>
        <div class="pwa-stage">
            <div class="ps-num" style="color:#a78bfa;">03</div>
            <div class="ps-body">
                <h4>Live Preview (HexCast)</h4>
                <p>Stream the running app via HexCast to any device. Debug in real-time with HexTerm. Measure performance with Blackwell app layer profiling. Iterate without deploying.</p>
                <div class="ps-tags">
                    <span class="ps-tag">hexcast</span>
                    <span class="ps-tag">terminal</span>
                    <span class="ps-tag">blackwell profiling</span>
                </div>
            </div>
        </div>
        <div class="pwa-stage">
            <div class="ps-num" style="color:#f0883e;">04</div>
            <div class="ps-body">
                <h4>Collaborative Editing (Synced Notepads)</h4>
                <p>Multiple users/AIs open the same notebook via BroadcastChannel sync. Each edits different blocks/cells. Prefix gutter shows who changed what dimension. Merge conflicts are structural, not line-based.</p>
                <div class="ps-tags">
                    <span class="ps-tag">BroadcastChannel</span>
                    <span class="ps-tag">dimensional diff</span>
                    <span class="ps-tag">multi-cursor</span>
                </div>
            </div>
        </div>
        <div class="pwa-stage">
            <div class="ps-num" style="color:#e2498a;">05</div>
            <div class="ps-body">
                <h4>PWA Build &amp; Deploy</h4>
                <p>One-click export from Notepad to a self-contained PWA HTML file. Service worker, manifest, icons â€” all generated. Push to GitHub Pages via the Dashboard. Works on every device: desktop, mobile, Quest, LEGO hub.</p>
                <div class="ps-tags">
                    <span class="ps-tag">PWA manifest</span>
                    <span class="ps-tag">GitHub Pages</span>
                    <span class="ps-tag">offline-first</span>
                    <span class="ps-tag">all devices</span>
                </div>
            </div>
        </div>
        <div class="pwa-stage">
            <div class="ps-num" style="color:#d4a017;">06</div>
            <div class="ps-body">
                <h4>Distributed App Workflow</h4>
                <p>The deployed app stays connected to its source notebook. Users tweak individual blocks/layers collaboratively. AI agents can modify parameters in real-time. The app evolves without full redeployment â€” hot-patch via prefix-aware diffs.</p>
                <div class="ps-tags">
                    <span class="ps-tag">hot-patch</span>
                    <span class="ps-tag">AI agents</span>
                    <span class="ps-tag">prefix-aware merge</span>
                    <span class="ps-tag">distributed</span>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” Roadmap â”â”â” -->
<section>
    <h2 class="fade-up">Building toward</h2>
    <p class="section-sub fade-up">The quantum gutter is the foundation. Here's where it's going.</p>

    <div class="roadmap fade-up">
        <div class="roadmap-item done">
            <h4>11-Symbol Classifier</h4>
            <p>Regex-based line classification for 20 languages. Sub-microsecond per line. Runs entirely in the browser with zero dependencies.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped</span>
        </div>
        <div class="roadmap-item done">
            <h4>Cross-App BroadcastChannel Sync</h4>
            <p>All 20 apps share prefix state via <code>BroadcastChannel('quantum-prefixes')</code>. Open notepad + terminal + hexbench â€” they stay in sync.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped</span>
        </div>
        <div class="roadmap-item done">
            <h4>3D Visual Navigation (Slice / Cube / Orb)</h4>
            <p>Navigate code by structure instead of line numbers. Slice isolates Z-layers, Cube shows all 27 cubelets, Orb maps probability density.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped</span>
        </div>
        <div class="roadmap-item done">
            <h4>Quantum Cell Type</h4>
            <p>Inline Slice/Cube/Orb as a notebook cell. Click, scroll, drag â€” full spatial code navigation inside any notebook.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped</span>
        </div>
        <div class="roadmap-item done">
            <h4>Game Blocks Builder (brotherNumsy)</h4>
            <p>24 block types across 8 prefix-mapped categories. Drag-drop canvas, connection graph, preset loader, export-to-code pipeline. Gamified AI integration foundation.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped</span>
        </div>
        <div class="roadmap-item done">
            <h4>GPU Architecture Layer Stack (Blackwell)</h4>
            <p>NVIDIA Blackwell Ultra SM as an interactive 7-layer visual stack with tweakable sliders, live sparklines, animated data flow. Each layer maps to a quantum prefix.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped</span>
        </div>
        <div class="roadmap-item done">
            <h4>AST-Backed Classification</h4>
            <p>Tree-sitter AST parsing in Rust (<code>crates/prefix-engine/src/ast.rs</code>). Exact node-type classification for Python, JS, TS, Rust, Go, C. Regex fallback for unsupported languages. Zero false positives.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
        <div class="roadmap-item done">
            <h4>SIMD-Vectorized Engine (Native)</h4>
            <p>Rust SIMD-friendly engine (<code>src/simd.rs</code>) with first-byte dispatch table and auto-vectorized batch processing. Target: 100M+ lines/sec. Ships as Tauri sidecar + WASM.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
        <div class="roadmap-item done">
            <h4>Multi-Manufacturer Architecture Views</h4>
            <p>5 GPU architectures live in Blackwell app: NVIDIA Blackwell, AMD CDNA 4, Intel Xe3, Apple M4 Ultra, Qualcomm Adreno X1. Click-to-swap layer stacks, specs, heatmaps. QPU quantum gate mapping with 11 gates.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
        <div class="roadmap-item done">
            <h4>AI Game Training (Neural Network)</h4>
            <p>brotherNumsy blocks generate real executable code. <code>nn_simple</code> neural network agent learns from gameplay with online weight updates. <code>numsyAI.train(episodes)</code> API for automated training sessions.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
        <div class="roadmap-item done">
            <h4>Dimensional Diff</h4>
            <p>Quantum Notepad tracks X/Y/Z spatial changes between snapshots. <code>notebook.showDimensionalDiff()</code> shows prefix shifts, not just line changes. Terminal commands: <code>diff</code> / <code>qdiff</code>.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
        <div class="roadmap-item done">
            <h4>Quantum Circuit Mapping + IoT Bridge</h4>
            <p><code>QuantumPrefixes.toQuantumCircuit(code, lang)</code> maps 11 prefix symbols to quantum gates (H, CNOT, X, Rz, I, S, T, SWAP, M, CZ, Y). ASCII circuit diagrams. <code>sendToQPU()</code> relays to IoT WebSocket bridge.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
        <div class="roadmap-item done">
            <h4>IDE Plugins (VS Code, Neovim)</h4>
            <p>VS Code extension (<code>editors/vscode/</code>) with gutter decorations, status bar, 6 commands. Neovim plugin (<code>editors/neovim/</code>) with Lua extmarks and autocmds. Zed plugin planned.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.3</span>
        </div>
        <div class="roadmap-item active">
            <h4>Concept â†’ PWA Pipeline</h4>
            <p>6-stage workflow: Blocks â†’ Code Gen â†’ Live Preview â†’ Collaborative Edit â†’ PWA Build â†’ Distributed App. Stage 1-3 shipped. Stage 5 (PWA Build) shipped via <code>export-pwa</code> command. Stage 4, 6 in progress.</p>
            <span class="rm-tag" style="background:rgba(88,166,255,0.15);color:#58a6ff;">In Progress â€” Stage 5 Shipped</span>
        </div>
        <div class="roadmap-item done">
            <h4>Physical QPU Integration</h4>
            <p>Local statevector simulator (QSim, up to 12 qubits) + IBM Quantum REST bridge (127-qubit Eagle, free tier). Hellinger fidelity scoring. Interactive in quantum-gutter.html and kbatch.html. Shared via <code>QuantumPrefixes.submitToIBM()</code>.</p>
            <span class="rm-tag" style="background:rgba(63,185,80,0.15);color:#3fb950;">Shipped â€” v4.18</span>
        </div>
        <div class="roadmap-item active">
            <h4>IDE Plugin: Cursor MCP + Prefix-Aware Autocomplete</h4>
            <p>Cursor MCP server with <code>uvspeed_prefix_gaps</code> gap analysis tool. VS Code extension ships circuit visualization (<code>quantumPrefixes.circuit</code> command â†’ QASM export). <code>prefix-autocomplete.mdc</code> Cursor rule for AI-driven gap filling. Zed native extension still planned.</p>
            <span class="rm-tag" style="background:rgba(88,166,255,0.15);color:#58a6ff;">In Progress â€” MCP + VS Code Shipped</span>
        </div>
    </div>
</section>

<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>

<!-- â”â”â” CTA â”â”â” -->
<div style="text-align:center;padding:80px 24px;position:relative;overflow:hidden;">
    <canvas id="cta-canvas" style="position:absolute;inset:0;z-index:0;"></canvas>
    <div style="position:relative;z-index:1;">
        <h2 style="font-size:2.5rem;font-weight:800;letter-spacing:-1px;margin-bottom:12px;">See code in 9 dimensions.</h2>
        <p style="color:#8b949e;font-size:1rem;margin-bottom:32px;">Open the notepad. Paste any code. Watch the gutter light up.</p>
        <div class="hero-actions">
            <a class="btn btn-primary" href="quantum-notepad.html">Open Quantum Notepad</a>
            <a class="btn btn-secondary" href="sponsor.html">Sponsor</a>
        </div>
    </div>
</div>

<!-- â”â”â” Footer â”â”â” -->
<div class="rainbow"><span class="r1"></span><span class="r2"></span><span class="r3"></span><span class="r4"></span><span class="r5"></span><span class="r6"></span></div>
<div class="footer">
    <div>{+1, 1, -1, +0, 0, -0, +n, n, -n}</div>
    <div style="margin-top:4px;">
        <a href="quantum-notepad.html">notepad</a> &middot;
        <a href="terminal.html">terminal</a> &middot;
        <a href="hexcast.html">hexcast</a> &middot;
        <a href="kbatch.html">kbatch</a> &middot;
        <a href="sponsor.html">sponsor</a> &middot;
        <a href="https://github.com/fornevercollective/uvspeed" target="_blank">github</a>
    </div>
    <div style="margin-top:8px;">uvspeed v4.3 &middot; fornevercollective &middot; MIT</div>
</div>

<script src="quantum-prefixes.js"></script>
<script>
(function() {
'use strict';

const QP = window.QuantumPrefixes;
const prefixes = [
    { sym: 'n:',  color: '#e2b714', cat: 'shebang',   desc: 'Entry points, shebangs' },
    { sym: '+1:', color: '#6a9955', cat: 'comment',    desc: 'Comments, docs, decorators' },
    { sym: '-n:', color: '#c586c0', cat: 'import',     desc: 'Imports, includes, requires' },
    { sym: '+0:', color: '#4ec9b0', cat: 'class',      desc: 'Class, struct, type, enum' },
    { sym: '0:',  color: '#569cd6', cat: 'function',   desc: 'Function, method defs' },
    { sym: '-1:', color: '#f44747', cat: 'error',      desc: 'Error handling, try/catch' },
    { sym: '+n:', color: '#d7ba7d', cat: 'condition',  desc: 'If/else/switch/match' },
    { sym: '+2:', color: '#9cdcfe', cat: 'loop',       desc: 'For/while/repeat loops' },
    { sym: '-0:', color: '#c586c0', cat: 'return',     desc: 'Return/yield statements' },
    { sym: '+3:', color: '#ce9178', cat: 'output',     desc: 'Print/echo/log/render' },
    { sym: '1:',  color: '#d4d4d4', cat: 'variable',   desc: 'Variable assignments' },
    { sym: '   ', color: '#808080', cat: 'default',    desc: 'Unclassified lines' },
];

// â”€â”€ Symbol grid â”€â”€
const symGrid = document.getElementById('sym-grid');
prefixes.forEach(p => {
    const card = document.createElement('div');
    card.className = 'sym-card';
    card.innerHTML = `
        <div class="sym" style="color:${p.color}">${p.sym.trim() || 'Â·'}</div>
        <div class="cat">${p.cat}</div>
        <div class="desc">${p.desc}</div>
    `;
    symGrid.appendChild(card);
});

// â”â”â” Interactive 3D Prefix Cube â”â”â”
(function initPrefixCube() {
    const cvs = document.getElementById('prefix-cube');
    if (!cvs) return;
    const ctx = cvs.getContext('2d');

    // High-DPI canvas setup
    function resize() {
        const rect = cvs.getBoundingClientRect();
        const dpr = window.devicePixelRatio || 1;
        cvs.width = rect.width * dpr;
        cvs.height = rect.height * dpr;
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    resize();
    window.addEventListener('resize', resize);

    // 11 prefix nodes arranged in grid (we'll place them on faces of a cube)
    // Use all 11 meaningful prefixes (excluding default space)
    const nodes = prefixes.slice(0, 11).map((p, i) => {
        // Map to 3D positions: 3x3 grid on different faces
        const row = Math.floor(i / 3);
        const col = i % 3;
        return {
            sym: p.sym.trim() || 'Â·',
            cat: p.cat,
            desc: p.desc,
            color: p.color,
            // Positions normalized -1..+1
            x: (col - 1) * 0.55,
            y: (row - 1) * 0.55,
            z: 0,
            // Orbit: place some nodes on different Z planes for depth
            oz: (i % 3 === 1) ? 0.4 : (i % 3 === 2) ? -0.4 : 0
        };
    });
    // Add the remaining prefixes (+3, 1:, default) as smaller orbiting particles
    const extras = prefixes.slice(9).map((p, i) => ({
        sym: p.sym.trim() || 'Â·', cat: p.cat, color: p.color,
        angle: (i / 3) * Math.PI * 2, dist: 0.85, speed: 0.2 + i * 0.08
    }));

    let rotX = -0.35, rotY = 0.45, zoom = 1.0;
    let dragging = false, lastMx = 0, lastMy = 0;
    let hovered = -1;
    let autoRotate = true, autoTimer = null;

    // Cube wireframe vertices
    const cubeVerts = [
        [-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],
        [-1,-1,1],[1,-1,1],[1,1,1],[-1,1,1]
    ];
    const cubeEdges = [
        [0,1],[1,2],[2,3],[3,0], // front
        [4,5],[5,6],[6,7],[7,4], // back
        [0,4],[1,5],[2,6],[3,7]  // connectors
    ];

    function rot3d(x, y, z) {
        // Rotate Y
        let x1 = x * Math.cos(rotY) - z * Math.sin(rotY);
        let z1 = x * Math.sin(rotY) + z * Math.cos(rotY);
        // Rotate X
        let y1 = y * Math.cos(rotX) - z1 * Math.sin(rotX);
        let z2 = y * Math.sin(rotX) + z1 * Math.cos(rotX);
        return [x1, y1, z2];
    }

    function project(x, y, z) {
        const [rx, ry, rz] = rot3d(x, y, z);
        const f = 2.8 / (4 + rz * zoom);
        const rect = cvs.getBoundingClientRect();
        const cx = rect.width / 2, cy = rect.height / 2;
        const scale = Math.min(rect.width, rect.height) * 0.38 * zoom;
        return { x: cx + rx * scale * f, y: cy + ry * scale * f, z: rz, scale: f };
    }

    // Mouse/touch interaction
    cvs.addEventListener('pointerdown', e => {
        dragging = true; lastMx = e.clientX; lastMy = e.clientY;
        autoRotate = false; clearTimeout(autoTimer);
        cvs.setPointerCapture(e.pointerId);
    });
    cvs.addEventListener('pointermove', e => {
        const rect = cvs.getBoundingClientRect();
        if (dragging) {
            rotY += (e.clientX - lastMx) * 0.008;
            rotX += (e.clientY - lastMy) * 0.008;
            rotX = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, rotX));
            lastMx = e.clientX; lastMy = e.clientY;
        }
        // Hover detection
        const mx = e.clientX - rect.left, my = e.clientY - rect.top;
        hovered = -1;
        for (let i = 0; i < nodes.length; i++) {
            const n = nodes[i];
            const p = project(n.x, n.y, n.z + n.oz);
            const dx = mx - p.x, dy = my - p.y;
            if (dx * dx + dy * dy < 900) { hovered = i; break; }
        }
        cvs.style.cursor = hovered >= 0 ? 'pointer' : (dragging ? 'grabbing' : 'grab');
    });
    cvs.addEventListener('pointerup', () => {
        dragging = false;
        autoTimer = setTimeout(() => { autoRotate = true; }, 4000);
    });
    cvs.addEventListener('wheel', e => {
        e.preventDefault();
        zoom = Math.max(0.5, Math.min(2.5, zoom - e.deltaY * 0.002));
    }, { passive: false });

    function draw() {
        const rect = cvs.getBoundingClientRect();
        const W = rect.width, H = rect.height;
        const t = Date.now() / 1000;
        const isLight = document.documentElement.getAttribute('data-theme') === 'light';

        ctx.clearRect(0, 0, W, H);

        if (autoRotate) {
            rotY += 0.003;
        }

        // â”€â”€ Cube wireframe â”€â”€
        const edgeColor = isLight ? 'rgba(100,110,120,0.18)' : 'rgba(88,166,255,0.12)';
        const faceColor = isLight ? 'rgba(200,210,220,0.06)' : 'rgba(88,166,255,0.03)';
        ctx.strokeStyle = edgeColor;
        ctx.lineWidth = 1;

        // Draw transparent faces (subtle)
        const faces = [
            [0,1,2,3],[4,5,6,7],[0,1,5,4],[2,3,7,6],[0,3,7,4],[1,2,6,5]
        ];
        const s = 0.65; // cube scale
        for (const face of faces) {
            ctx.beginPath();
            face.forEach((vi, fi) => {
                const v = cubeVerts[vi];
                const p = project(v[0] * s, v[1] * s, v[2] * s);
                fi === 0 ? ctx.moveTo(p.x, p.y) : ctx.lineTo(p.x, p.y);
            });
            ctx.closePath();
            ctx.fillStyle = faceColor;
            ctx.fill();
        }

        // Draw edges
        for (const [a, b] of cubeEdges) {
            const va = cubeVerts[a], vb = cubeVerts[b];
            const pa = project(va[0] * s, va[1] * s, va[2] * s);
            const pb = project(vb[0] * s, vb[1] * s, vb[2] * s);
            ctx.beginPath(); ctx.moveTo(pa.x, pa.y); ctx.lineTo(pb.x, pb.y); ctx.stroke();
        }

        // â”€â”€ Inner grid lines â”€â”€
        const gridColor = isLight ? 'rgba(100,110,120,0.08)' : 'rgba(88,166,255,0.06)';
        ctx.strokeStyle = gridColor;
        ctx.lineWidth = 0.5;
        for (let g = -1; g <= 1; g += 1) {
            const gn = g * 0.33 * s * 2;
            // Vertical planes (X-fixed)
            const p1 = project(gn, -s, -s), p2 = project(gn, s, -s);
            const p3 = project(gn, s, s), p4 = project(gn, -s, s);
            ctx.beginPath(); ctx.moveTo(p1.x, p1.y); ctx.lineTo(p2.x, p2.y); ctx.lineTo(p3.x, p3.y); ctx.lineTo(p4.x, p4.y); ctx.closePath(); ctx.stroke();
            // Horizontal planes (Y-fixed)
            const q1 = project(-s, gn, -s), q2 = project(s, gn, -s);
            const q3 = project(s, gn, s), q4 = project(-s, gn, s);
            ctx.beginPath(); ctx.moveTo(q1.x, q1.y); ctx.lineTo(q2.x, q2.y); ctx.lineTo(q3.x, q3.y); ctx.lineTo(q4.x, q4.y); ctx.closePath(); ctx.stroke();
        }

        // â”€â”€ Orbiting extra particles â”€â”€
        for (const ex of extras) {
            ex.angle += 0.008 * ex.speed;
            const ox = Math.cos(ex.angle + t * 0.1) * ex.dist * s;
            const oy = Math.sin(ex.angle * 0.7 + t * 0.15) * ex.dist * s * 0.5;
            const oz = Math.sin(ex.angle + t * 0.1) * ex.dist * s;
            const p = project(ox, oy, oz);
            const r = 4 * p.scale * zoom;
            ctx.globalAlpha = 0.5;
            ctx.fillStyle = ex.color;
            ctx.beginPath(); ctx.arc(p.x, p.y, Math.max(r, 2), 0, Math.PI * 2); ctx.fill();
            ctx.globalAlpha = 1;
            // Label
            ctx.fillStyle = isLight ? 'rgba(80,80,80,0.5)' : 'rgba(200,200,200,0.4)';
            ctx.font = `${Math.max(7, 9 * p.scale * zoom)}px "SF Mono", monospace`;
            ctx.textAlign = 'center';
            ctx.fillText(ex.sym, p.x, p.y - Math.max(r, 2) - 3);
        }

        // â”€â”€ Prefix nodes (depth-sorted) â”€â”€
        const projected = nodes.map((n, i) => {
            const p = project(n.x, n.y, n.z + n.oz + Math.sin(t * 0.5 + i) * 0.04);
            return { ...n, px: p.x, py: p.y, pz: p.z, ps: p.scale, idx: i };
        }).sort((a, b) => a.pz - b.pz); // back to front

        for (const n of projected) {
            const isH = hovered === n.idx;
            const baseR = isH ? 28 : 20;
            const r = baseR * n.ps * zoom;

            // Glow
            if (isH) {
                const glow = ctx.createRadialGradient(n.px, n.py, r * 0.3, n.px, n.py, r * 2.5);
                glow.addColorStop(0, n.color + '44');
                glow.addColorStop(1, 'transparent');
                ctx.fillStyle = glow;
                ctx.beginPath(); ctx.arc(n.px, n.py, r * 2.5, 0, Math.PI * 2); ctx.fill();
            }

            // Node sphere
            const grad = ctx.createRadialGradient(n.px - r * 0.25, n.py - r * 0.25, r * 0.1, n.px, n.py, r);
            grad.addColorStop(0, isLight ? '#fff' : n.color + 'dd');
            grad.addColorStop(0.6, n.color + (isH ? 'cc' : '88'));
            grad.addColorStop(1, n.color + '22');
            ctx.fillStyle = grad;
            ctx.beginPath(); ctx.arc(n.px, n.py, Math.max(r, 6), 0, Math.PI * 2); ctx.fill();

            // Border
            ctx.strokeStyle = n.color + (isH ? 'ff' : '66');
            ctx.lineWidth = isH ? 2 : 1;
            ctx.stroke();

            // Symbol text
            const fontSize = Math.max(9, (isH ? 16 : 12) * n.ps * zoom);
            ctx.font = `bold ${fontSize}px "SF Mono", monospace`;
            ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
            ctx.fillStyle = isLight ? '#1a1a1a' : '#fff';
            ctx.fillText(n.sym, n.px, n.py);

            // Category label
            if (isH || r > 14) {
                const catFontSize = Math.max(7, 9 * n.ps * zoom);
                ctx.font = `600 ${catFontSize}px -apple-system, sans-serif`;
                ctx.fillStyle = isLight ? 'rgba(60,60,60,0.8)' : 'rgba(200,200,200,0.7)';
                ctx.fillText(n.cat, n.px, n.py + Math.max(r, 6) + catFontSize + 2);
            }

            // Hover detail tooltip
            if (isH) {
                const tipY = n.py - Math.max(r, 6) - 28;
                const tipText = `${n.sym}  ${n.cat} â€” ${n.desc}`;
                ctx.font = '11px "SF Mono", monospace';
                const tw = ctx.measureText(tipText).width;
                const pad = 8;
                const tipX = Math.max(pad + tw / 2 + 4, Math.min(W - tw / 2 - pad - 4, n.px));
                // Background pill
                ctx.fillStyle = isLight ? 'rgba(255,255,255,0.92)' : 'rgba(22,27,34,0.92)';
                ctx.strokeStyle = n.color + '66';
                ctx.lineWidth = 1;
                const rr = 6;
                ctx.beginPath();
                ctx.roundRect(tipX - tw / 2 - pad, tipY - 12, tw + pad * 2, 24, rr);
                ctx.fill(); ctx.stroke();
                // Text
                ctx.fillStyle = isLight ? '#24292f' : '#e6edf3';
                ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
                ctx.fillText(tipText, tipX, tipY);
            }
        }

        // â”€â”€ Connection lines between adjacent nodes â”€â”€
        ctx.globalAlpha = 0.15;
        ctx.strokeStyle = isLight ? '#555' : '#58a6ff';
        ctx.lineWidth = 0.8;
        for (let i = 0; i < projected.length; i++) {
            for (let j = i + 1; j < projected.length; j++) {
                const a = projected[i], b = projected[j];
                const dx = a.px - b.px, dy = a.py - b.py;
                if (dx * dx + dy * dy < 18000) {
                    ctx.beginPath(); ctx.moveTo(a.px, a.py); ctx.lineTo(b.px, b.py); ctx.stroke();
                }
            }
        }
        ctx.globalAlpha = 1;

        // â”€â”€ Floating energy particles â”€â”€
        for (let i = 0; i < 12; i++) {
            const angle = t * 0.3 + i * (Math.PI * 2 / 12);
            const radius = 0.5 + Math.sin(t * 0.5 + i * 0.8) * 0.25;
            const px = Math.cos(angle) * radius * s;
            const py = Math.sin(angle * 0.7) * radius * s * 0.6;
            const pz = Math.sin(angle) * radius * s;
            const p = project(px, py, pz);
            const pr = 1.5 * p.scale * zoom;
            ctx.fillStyle = isLight ? 'rgba(80,100,140,0.2)' : 'rgba(88,166,255,0.2)';
            ctx.beginPath(); ctx.arc(p.x, p.y, Math.max(pr, 0.8), 0, Math.PI * 2); ctx.fill();
        }

        requestAnimationFrame(draw);
    }
    draw();
})();

// â”€â”€ Live editor â”€â”€
const codeInput = document.getElementById('code-input');
const gutterOutput = document.getElementById('gutter-output');
const gutterStats = document.getElementById('gutter-stats');
const langSelect = document.getElementById('lang-select');

function updateGutter() {
    if (!QP) return;
    const code = codeInput.value;
    const lang = langSelect.value;
    const lines = code.split('\n');
    let classified = 0;
    let html = '';
    for (let i = 0; i < lines.length; i++) {
        const result = QP.classifyLine(lines[i], lang);
        if (result.category !== 'default') classified++;
        const color = result.color || '#808080';
        const escaped = lines[i].replace(/</g, '&lt;').replace(/>/g, '&gt;');
        html += `<div class="gutter-line"><span class="gl-sym" style="color:${color}">${result.sym}</span><span class="gl-code">${escaped}</span></div>`;
    }
    gutterOutput.innerHTML = html;
    const cov = lines.length ? Math.round((classified / lines.length) * 100) : 0;
    gutterStats.textContent = `${classified}/${lines.length} classified Â· ${cov}% coverage`;
}
codeInput.addEventListener('input', updateGutter);
langSelect.addEventListener('change', updateGutter);
updateGutter();

// â”€â”€ Benchmarks â”€â”€
const benchGrid = document.getElementById('bench-grid');
const benchDefs = [
    { id: 'classify', label: 'classifyLine()', unit: 'lines/sec', icon: 'âš¡', color: '#3fb950', max: 5000000 },
    { id: 'prefix',   label: 'prefixContent()', unit: 'ops/sec', icon: 'ðŸ”¬', color: '#58a6ff', max: 100000 },
    { id: 'metadata', label: 'prefixMetadata()', unit: 'ops/sec', icon: 'ðŸ“Š', color: '#bc8cff', max: 80000 },
    { id: 'detect',   label: 'detectLanguage()', unit: 'ops/sec', icon: 'ðŸŒ', color: '#d7ba7d', max: 200000 },
];

benchDefs.forEach(b => {
    const card = document.createElement('div');
    card.className = 'bench-card';
    card.innerHTML = `
        <h4>${b.icon} ${b.label}</h4>
        <div class="bench-value" id="bv-${b.id}" style="color:${b.color}">â€”</div>
        <div class="bench-unit">${b.unit}</div>
        <div class="bench-bar"><div class="bench-fill" id="bf-${b.id}" style="width:0%;background:${b.color}"></div></div>
    `;
    benchGrid.appendChild(card);
});

const sampleCode = codeInput.value;
const sampleLines = sampleCode.split('\n');

function runBenchmarks() {
    if (!QP) return;
    // classifyLine
    const t0 = performance.now();
    let ops = 0;
    while (performance.now() - t0 < 200) {
        for (let i = 0; i < sampleLines.length; i++) { QP.classifyLine(sampleLines[i], 'python'); ops++; }
    }
    const clRate = Math.round(ops / ((performance.now() - t0) / 1000));
    document.getElementById('bv-classify').textContent = clRate.toLocaleString();
    document.getElementById('bf-classify').style.width = Math.min(100, (clRate / benchDefs[0].max) * 100) + '%';
    document.getElementById('st-lines').textContent = (clRate / 1000000).toFixed(1) + 'M';

    // prefixContent
    const t1 = performance.now(); let pc = 0;
    while (performance.now() - t1 < 200) { QP.prefixContent(sampleCode, 'python'); pc++; }
    const pcRate = Math.round(pc / ((performance.now() - t1) / 1000));
    document.getElementById('bv-prefix').textContent = pcRate.toLocaleString();
    document.getElementById('bf-prefix').style.width = Math.min(100, (pcRate / benchDefs[1].max) * 100) + '%';

    // prefixMetadata
    const t2 = performance.now(); let pm = 0;
    while (performance.now() - t2 < 200) { QP.prefixMetadata(sampleCode, 'python'); pm++; }
    const pmRate = Math.round(pm / ((performance.now() - t2) / 1000));
    document.getElementById('bv-metadata').textContent = pmRate.toLocaleString();
    document.getElementById('bf-metadata').style.width = Math.min(100, (pmRate / benchDefs[2].max) * 100) + '%';

    // detectLanguage
    const t3 = performance.now(); let dl = 0;
    while (performance.now() - t3 < 200) { QP.detectLanguage(sampleCode); dl++; }
    const dlRate = Math.round(dl / ((performance.now() - t3) / 1000));
    document.getElementById('bv-detect').textContent = dlRate.toLocaleString();
    document.getElementById('bf-detect').style.width = Math.min(100, (dlRate / benchDefs[3].max) * 100) + '%';

    // Update coverage stat
    const meta = QP.prefixMetadata(sampleCode, 'python');
    document.getElementById('st-coverage').textContent = meta.coverage + '%';
}

document.getElementById('bench-run').addEventListener('click', () => {
    document.getElementById('bench-run').textContent = 'â³ Running...';
    setTimeout(() => { runBenchmarks(); document.getElementById('bench-run').textContent = 'â–¶ Run Benchmarks'; }, 50);
});
setTimeout(runBenchmarks, 500);

// â”€â”€ Language coverage chart â”€â”€
const covChart = document.getElementById('cov-chart');
const langData = [
    { lang: 'Python', cov: 95, color: '#3fb950' }, { lang: 'JavaScript', cov: 93, color: '#58a6ff' },
    { lang: 'TypeScript', cov: 92, color: '#569cd6' }, { lang: 'Rust', cov: 90, color: '#f0883e' },
    { lang: 'Go', cov: 89, color: '#3fb950' }, { lang: 'C/C++', cov: 88, color: '#9cdcfe' },
    { lang: 'Swift', cov: 87, color: '#ff7b72' }, { lang: 'Kotlin', cov: 86, color: '#d2a8ff' },
    { lang: 'Java', cov: 91, color: '#f0883e' }, { lang: 'C#', cov: 88, color: '#bc8cff' },
    { lang: 'Ruby', cov: 85, color: '#f85149' }, { lang: 'PHP', cov: 82, color: '#8b949e' },
    { lang: 'Shell', cov: 80, color: '#3fb950' }, { lang: 'SQL', cov: 78, color: '#58a6ff' },
    { lang: 'HTML/CSS', cov: 75, color: '#f0883e' }, { lang: 'YAML/TOML', cov: 72, color: '#d7ba7d' },
    { lang: 'Zig', cov: 85, color: '#f0883e' }, { lang: 'Haskell', cov: 80, color: '#bc8cff' },
    { lang: 'Elixir', cov: 78, color: '#d2a8ff' }, { lang: 'WGSL', cov: 68, color: '#8b949e' },
];
langData.sort((a, b) => b.cov - a.cov);
langData.forEach(d => {
    const row = document.createElement('div');
    row.className = 'cov-row';
    row.innerHTML = `
        <span class="cov-lang">${d.lang}</span>
        <div class="cov-bar"><div class="cov-fill" style="width:${d.cov}%;background:${d.color}">${d.cov}%</div></div>
    `;
    covChart.appendChild(row);
});

// â”€â”€ Visual Canvases â”€â”€
const pfxColors = ['#3fb950','#58a6ff','#bc8cff','#f0883e','#8b949e','#f85149','#d2a8ff','#79c0ff','#e3b341','#58d1f0','#f9c74f'];
const pfxNames  = ['+1','1','-1','+0','0','-0','+n','n','-n','+2','+3'];

function hexRgba(hex, a) {
    return 'rgba(' + parseInt(hex.slice(1,3),16) + ',' + parseInt(hex.slice(3,5),16) + ',' + parseInt(hex.slice(5,7),16) + ',' + a + ')';
}

// SLICE
const cvSlice = document.getElementById('cv-slice');
const ctxSlice = cvSlice ? cvSlice.getContext('2d') : null;
let slicePos = [0, 0, 0];
if (cvSlice) {
    cvSlice.addEventListener('click', e => {
        const r = cvSlice.getBoundingClientRect();
        slicePos[0] = Math.floor(((e.clientX - r.left) / r.width) * 9);
        slicePos[1] = Math.floor(((e.clientY - r.top) / r.height) * 9);
    });
    cvSlice.addEventListener('wheel', e => { e.preventDefault(); slicePos[2] += e.deltaY > 0 ? -1 : 1; }, { passive: false });
}

// ORB
const cvOrb = document.getElementById('cv-orb');
const ctxOrb = cvOrb ? cvOrb.getContext('2d') : null;

// HEX STREAM
const cvHex = document.getElementById('cv-hex');
const ctxHex = cvHex ? cvHex.getContext('2d') : null;
const hexColumns = [];
for (let i = 0; i < 40; i++) hexColumns.push({ y: Math.random() * 280, speed: 0.3 + Math.random() * 1.5, chars: [], color: pfxColors[i % 11] });

let frame = 0;

function drawSlice(t) {
    if (!ctxSlice) return;
    const W = cvSlice.width, H = cvSlice.height, ctx = ctxSlice;
    const layer = Math.abs(slicePos[2]) % 6;
    ctx.fillStyle = '#0d1117'; ctx.fillRect(0, 0, W, H);
    const grid = 11, cellW = W / grid, cellH = H / grid;
    for (let r = 0; r < grid; r++) for (let c = 0; c < grid; c++) {
        const x = c * cellW, y = r * cellH;
        const heat = Math.sin(t * 0.02 + c * 0.8 + r * 0.6 + layer * 1.3) * 0.5 + 0.5;
        const active = (c === Math.abs(slicePos[0]) % grid && r === Math.abs(slicePos[1]) % grid);
        ctx.fillStyle = active ? 'rgba(139,92,246,' + (0.5 + Math.sin(t * 0.08) * 0.2) + ')' : hexRgba(pfxColors[c], 0.15 + heat * 0.35);
        ctx.fillRect(x + 1, y + 1, cellW - 2, cellH - 2);
        ctx.strokeStyle = active ? 'rgba(139,92,246,0.8)' : 'rgba(255,255,255,' + (0.05 + heat * 0.08) + ')';
        ctx.lineWidth = active ? 2 : 0.5;
        ctx.strokeRect(x + 1, y + 1, cellW - 2, cellH - 2);
        if (heat > 0.6) {
            ctx.beginPath(); ctx.arc(x + cellW * (0.5 + Math.sin(t * 0.03 + c) * 0.3), y + cellH * (0.5 + Math.cos(t * 0.025 + r) * 0.3), 2 + heat * 2, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255,255,255,' + heat * 0.5 + ')'; ctx.fill();
        }
    }
    ctx.font = 'bold 10px monospace'; ctx.textAlign = 'center';
    for (let c = 0; c < grid; c++) { ctx.fillStyle = pfxColors[c]; ctx.fillText(pfxNames[c], c * cellW + cellW / 2, 13); }
    ctx.textAlign = 'start'; ctx.fillStyle = 'rgba(255,255,255,0.35)'; ctx.font = '9px monospace';
    ctx.fillText('Z-Layer ' + slicePos[2] + '  |  Click cell Â· Scroll Z', 6, H - 6);
}

function drawOrb(t) {
    if (!ctxOrb) return;
    const W = cvOrb.width, H = cvOrb.height, ctx = ctxOrb;
    ctx.fillStyle = '#0d1117'; ctx.fillRect(0, 0, W, H);
    const cx = W / 2, cy = H / 2, maxR = Math.min(W, H) * 0.42;
    for (let ring = 3; ring >= 0; ring--) {
        const r = maxR * (0.4 + ring * 0.2), pulse = Math.sin(t * 0.02 + ring * 1.5) * 0.1 + 0.9;
        ctx.beginPath(); ctx.arc(cx, cy, r * pulse, 0, Math.PI * 2);
        ctx.strokeStyle = 'rgba(139,92,246,' + (0.06 + ring * 0.04) + ')'; ctx.lineWidth = 1; ctx.stroke();
        ctx.beginPath(); ctx.ellipse(cx, cy, r * pulse, r * pulse * 0.35, t * 0.003 + ring, 0, Math.PI * 2);
        ctx.strokeStyle = 'rgba(88,166,255,' + (0.05 + ring * 0.03) + ')'; ctx.stroke();
    }
    for (let i = 0; i < 120; i++) {
        const angle = (Math.PI * 2 / 120) * i + t * 0.008;
        const phi = Math.sin(t * 0.01 + i * 0.5) * Math.PI * 0.8;
        const rDist = maxR * (0.2 + Math.abs(Math.sin(i * 1.618 + t * 0.005)) * 0.75);
        const px = cx + Math.cos(angle) * rDist * Math.cos(phi);
        const py = cy + Math.sin(angle) * rDist * 0.6 + Math.sin(phi) * rDist * 0.3;
        const sz = 1.5 + Math.sin(t * 0.015 + i) * 1;
        const bright = 0.2 + Math.abs(Math.sin(t * 0.01 + i * 0.7)) * 0.6;
        ctx.beginPath(); ctx.arc(px, py, sz, 0, Math.PI * 2);
        ctx.fillStyle = hexRgba(pfxColors[i % 11], bright); ctx.fill();
    }
    ctx.fillStyle = 'rgba(255,255,255,0.3)'; ctx.font = '9px monospace';
    ctx.fillText('Quantum Orb  |  120 particles  |  Prefix density', 6, H - 6);
}

function drawHexStream(t) {
    if (!ctxHex) return;
    const W = cvHex.width, H = cvHex.height, ctx = ctxHex;
    ctx.fillStyle = 'rgba(13,17,23,0.15)'; ctx.fillRect(0, 0, W, H);
    const colW = W / hexColumns.length;
    ctx.font = '10px monospace';
    for (let i = 0; i < hexColumns.length; i++) {
        const col = hexColumns[i];
        col.y += col.speed;
        if (col.y > H + 20) { col.y = -10; col.color = pfxColors[Math.floor(Math.random() * 11)]; }
        const hex = ((t * 7 + i * 0x3F1) & 0xFFFF).toString(16).padStart(4, '0');
        const alpha = 0.3 + Math.sin(t * 0.05 + i) * 0.2 + 0.3;
        ctx.fillStyle = hexRgba(col.color, alpha);
        ctx.fillText(hex, i * colW + 2, col.y);
        // Fading trail
        for (let j = 1; j <= 5; j++) {
            ctx.fillStyle = hexRgba(col.color, alpha * (1 - j * 0.18));
            const trailHex = (((t - j * 3) * 7 + i * 0x3F1) & 0xFFFF).toString(16).padStart(4, '0');
            ctx.fillText(trailHex, i * colW + 2, col.y - j * 14);
        }
    }
    ctx.fillStyle = 'rgba(255,255,255,0.3)'; ctx.font = '9px monospace';
    ctx.fillText('Hex Stream  |  40 columns  |  Prefix-colored data flow', 6, H - 6);
}

function tick() {
    frame++;
    drawSlice(frame);
    drawOrb(frame);
    drawHexStream(frame);
    requestAnimationFrame(tick);
}
tick();

// â”€â”€ Inverse Starfield (theme-aware: bright on dark, dark on light) â”€â”€
function initStarfield(cvs, count) {
    if (!cvs) return;
    const ctx = cvs.getContext('2d');
    const stars = [];
    function resize() { cvs.width = cvs.parentElement.offsetWidth; cvs.height = cvs.parentElement.offsetHeight; }
    resize(); window.addEventListener('resize', resize);
    // Mix of white and colored stars
    const starColors = ['255,255,255','200,200,220','180,160,255','160,220,255','255,200,140','200,255,180'];
    for (let i = 0; i < count; i++) stars.push({
        x: Math.random() * 3000, y: Math.random() * 1200,
        r: Math.random() * 1.6 + 0.2, a: Math.random() * 0.7 + 0.15,
        tw: Math.random() * 2 + 0.5, ph: Math.random() * Math.PI * 2,
        c: starColors[Math.floor(Math.random() * starColors.length)],
        ci: Math.random() < 0.3 ? '40,50,60' : '0,0,0' // dark star colors for light mode
    });
    function draw() {
        ctx.clearRect(0, 0, cvs.width, cvs.height);
        const t = Date.now() / 1000;
        const isLight = document.documentElement.getAttribute('data-theme') === 'light';
        for (const s of stars) {
            const alpha = 0.1 + 0.9 * s.a * (0.5 + 0.5 * Math.sin(t * s.tw + s.ph));
            if (isLight) {
                // Inverse: dark/muted stars on light background
                ctx.fillStyle = `rgba(${s.ci},${alpha * 0.35})`;
            } else {
                ctx.fillStyle = `rgba(${s.c},${alpha})`;
            }
            ctx.beginPath(); ctx.arc(s.x % cvs.width, s.y % cvs.height, s.r, 0, Math.PI * 2); ctx.fill();
        }
        requestAnimationFrame(draw);
    }
    draw();
}
initStarfield(document.getElementById('hero-canvas'), 250);
initStarfield(document.getElementById('cta-canvas'), 150);

// â”€â”€ Scroll reveal â”€â”€
const obs = new IntersectionObserver(entries => {
    entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
}, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });
document.querySelectorAll('.fade-up').forEach(el => obs.observe(el));

// â”€â”€ Coverage bar animation â”€â”€
const covObs = new IntersectionObserver(entries => {
    entries.forEach(e => {
        if (e.isIntersecting) {
            e.target.querySelectorAll('.cov-fill').forEach(f => {
                const w = f.style.width; f.style.width = '0%';
                requestAnimationFrame(() => requestAnimationFrame(() => { f.style.width = w; }));
            });
            covObs.unobserve(e.target);
        }
    });
}, { threshold: 0.3 });
document.querySelectorAll('.cov-chart').forEach(el => covObs.observe(el));

// â”€â”€ QPU Interactive Section â”€â”€
(function() {
    var QP = window.QuantumPrefixes;
    if (!QP || !QP.QSim) return;

    var tokenInput = document.getElementById('gutter-qpu-token');
    var backendSel = document.getElementById('gutter-qpu-backend');
    var shotInput = document.getElementById('gutter-qpu-shots');
    var circuitPre = document.getElementById('gutter-qpu-circuit');
    var statusEl = document.getElementById('gutter-qpu-status');
    var resultInfo = document.getElementById('gutter-qpu-result-info');
    var fidelityBadge = document.getElementById('gutter-fidelity');
    var canvas = document.getElementById('cv-qpu-histogram');

    var savedToken = localStorage.getItem('ibm-quantum-token');
    if (savedToken && tokenInput) tokenInput.value = savedToken;

    var lastCircuit = null;
    var localResult = null;

    function getEditorCode() {
        var editor = document.getElementById('code-input');
        if (editor && editor.value && editor.value.trim()) return editor.value;
        return '#!/usr/bin/env python3\n# Quantum prefix demo\nimport numpy as np\n\nclass QuantumState:\n    def __init__(self, n=3):\n        self.state = np.zeros(2**n)\n        self.state[0] = 1.0\n\n    def measure(self):\n        try:\n            probs = np.abs(self.state)**2\n            return probs\n        except Exception as e:\n            print(f"Error: {e}")\n\nqs = QuantumState()\nresult = qs.measure()\nprint(result)';
    }

    document.getElementById('gutter-qpu-build').addEventListener('click', function() {
        var code = getEditorCode();
        lastCircuit = QP.toQuantumCircuit(code, QP.detectLanguage(code, 'python'));
        circuitPre.textContent = lastCircuit.circuit + '\n\n// ' + lastCircuit.qubits + ' qubits, ' + lastCircuit.depth + ' gates';
        statusEl.textContent = 'Circuit built: ' + lastCircuit.qubits + ' qubits, ' + lastCircuit.depth + ' gates';
    });

    document.getElementById('gutter-qpu-run').addEventListener('click', function() {
        if (!lastCircuit) document.getElementById('gutter-qpu-build').click();
        if (!lastCircuit) return;

        var shots = parseInt(shotInput.value) || 1024;
        var backend = backendSel.value;

        if (backend === 'local') {
            statusEl.textContent = 'Simulating locally...';
            var code = getEditorCode();
            var result = QP.simulateCircuit(code, QP.detectLanguage(code, 'python'), shots);
            localResult = result.counts;
            renderHistogram(canvas, localResult);
            var numStates = Object.keys(localResult).length;
            statusEl.textContent = 'Local simulation complete: ' + numStates + ' states, ' + shots + ' shots';
            resultInfo.textContent = numStates + ' unique measurement outcomes';
            fidelityBadge.style.display = 'none';
        } else {
            var token = tokenInput.value.trim();
            if (!token) { statusEl.textContent = 'Error: Enter IBM Quantum API token'; return; }
            localStorage.setItem('ibm-quantum-token', token);
            statusEl.textContent = 'Submitting to ' + backend + '...';

            QP.submitToIBM(lastCircuit, token, backend, shots).then(function(counts) {
                renderHistogram(canvas, counts);
                var numStates = Object.keys(counts).length;
                statusEl.textContent = 'IBM ' + backend + ' complete: ' + numStates + ' states';
                resultInfo.textContent = numStates + ' unique measurement outcomes from real QPU';

                if (localResult) {
                    var fidelity = QP.hellingerFidelity(localResult, counts);
                    fidelityBadge.style.display = 'inline-block';
                    fidelityBadge.textContent = 'Fidelity: ' + (fidelity * 100).toFixed(1) + '%';
                    fidelityBadge.style.background = fidelity > 0.8 ? 'rgba(63,185,80,0.15)' : fidelity > 0.5 ? 'rgba(210,167,0,0.15)' : 'rgba(248,81,73,0.15)';
                    fidelityBadge.style.color = fidelity > 0.8 ? '#3fb950' : fidelity > 0.5 ? '#d4a017' : '#f85149';
                }
            }).catch(function(err) {
                statusEl.textContent = 'Error: ' + err.message;
            });
        }
    });

    function renderHistogram(cvs, counts) {
        if (!cvs || !cvs.parentElement) return;
        var ctx = cvs.getContext('2d');
        var W = cvs.width = cvs.parentElement.clientWidth;
        var H = cvs.height = cvs.parentElement.clientHeight;
        ctx.fillStyle = '#0d1117'; ctx.fillRect(0, 0, W, H);
        if (!counts || Object.keys(counts).length === 0) return;

        var sorted = Object.entries(counts).sort(function(a,b) { return b[1]-a[1]; });
        var top = sorted.slice(0, Math.min(sorted.length, 32));
        var maxVal = Math.max(1, top[0][1]);
        var total = 0;
        for (var k in counts) total += counts[k];
        var barW = Math.max(8, (W - 60) / top.length - 4);
        var maxH = H - 55;

        top.forEach(function(entry, i) {
            var state = entry[0], count = entry[1];
            var x = 40 + i * (barW + 4);
            var h = (count / maxVal) * maxH;
            var y = H - 30 - h;
            var prob = count / total;
            var hue = 270 - prob * 200;
            ctx.fillStyle = 'hsl(' + hue + ', 70%, 55%)';
            ctx.fillRect(x, y, barW, h);
            ctx.fillStyle = '#c9d1d9'; ctx.font = '8px monospace'; ctx.textAlign = 'center';
            ctx.fillText((prob * 100).toFixed(1) + '%', x + barW/2, y - 4);
            ctx.save(); ctx.translate(x + barW/2, H - 26);
            ctx.rotate(-Math.PI / 4);
            ctx.fillStyle = '#8b949e'; ctx.font = Math.min(10, barW) + 'px monospace';
            ctx.textAlign = 'right';
            ctx.fillText('|' + state + '\u27E9', 0, 0);
            ctx.restore();
        });
        ctx.fillStyle = '#a371f7'; ctx.font = 'bold 10px monospace'; ctx.textAlign = 'left';
        ctx.fillText(Object.keys(counts).length + ' states | ' + total + ' shots', 8, 14);
    }
})();

// â”€â”€ Calibration Benchmark â”€â”€
(function() {
    var QP = window.QuantumPrefixes;
    if (!QP || !QP.simulateCircuit) return;

    var SAMPLES = {
        python: '#!/usr/bin/env python3\n# Quantum computation module\nimport numpy as np\nfrom tinygrad.tensor import Tensor\n\nclass QuantumState:\n    """Represents a quantum state vector."""\n\n    def __init__(self, qubits=3):\n        self.n = qubits\n        self.state = Tensor.randn(2 ** qubits)\n\n    def normalize(self):\n        return self.state / self.state.norm()\n\n    def measure(self):\n        try:\n            probs = (self.state ** 2).numpy()\n            return probs\n        except Exception as e:\n            print(f"Measurement error: {e}")',
        javascript: '// UV-Speed prefix engine\nimport { classifyLine } from "./quantum-prefixes.js";\n\nclass PrefixEngine {\n    constructor(language) {\n        this.lang = language;\n        this.cache = new Map();\n    }\n\n    classify(code) {\n        const lines = code.split("\\n");\n        const results = [];\n        for (const line of lines) {\n            if (this.cache.has(line)) {\n                results.push(this.cache.get(line));\n            } else {\n                try {\n                    const r = classifyLine(line, this.lang);\n                    this.cache.set(line, r);\n                    results.push(r);\n                } catch (e) {\n                    console.error("Classify error:", e);\n                }\n            }\n        }\n        return results;\n    }\n}',
        rust: '//! Quantum prefix classifier â€” Rust edition\nuse std::collections::HashMap;\n\nstruct Classifier {\n    cache: HashMap<String, PrefixResult>,\n    language: String,\n}\n\nimpl Classifier {\n    fn new(lang: &str) -> Self {\n        Classifier { cache: HashMap::new(), language: lang.to_string() }\n    }\n\n    fn classify(&mut self, line: &str) -> PrefixResult {\n        if let Some(cached) = self.cache.get(line) {\n            return cached.clone();\n        }\n        let result = match line.trim_start().chars().next() {\n            Some(\'/\') => PrefixResult::Comment,\n            Some(\'#\') => PrefixResult::Comment,\n            _ => PrefixResult::Unknown,\n        };\n        self.cache.insert(line.to_string(), result.clone());\n        println!("Classified: {:?}", result);\n        result\n    }\n}',
        html: '<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <title>Quantum Gutter</title>\n    <!-- quantum prefix engine -->\n    <script src="quantum-prefixes.js"></script>\n    <style>\n        body { margin: 0; background: #0d1117; color: #c9d1d9; }\n        .gutter { font-family: monospace; }\n    </style>\n</head>\n<body>\n    <div class="gutter" id="app"></div>\n    <script>\n        const QP = window.QuantumPrefixes;\n        if (QP) {\n            const meta = QP.prefixMetadata(document.body.textContent, "html");\n            console.log("Coverage:", meta.coverage);\n        }\n    </script>\n</body>\n</html>',
        shell: '#!/bin/bash\n# UV-Speed build pipeline\nset -euo pipefail\n\nBUILD_DIR="./dist"\nVERSION=$(cat VERSION)\n\necho "Building uvspeed v${VERSION}..."\n\n# Clean\nrm -rf "$BUILD_DIR"\nmkdir -p "$BUILD_DIR"\n\n# Build WASM\nif command -v wasm-pack &>/dev/null; then\n    echo "Building WASM..."\n    wasm-pack build crates/prefix-engine --target web\nelse\n    echo "WARN: wasm-pack not found, skipping WASM"\nfi\n\n# Copy web assets\nfor f in web/*.html web/*.js; do\n    cp "$f" "$BUILD_DIR/"\n    echo "  Copied: $(basename $f)"\ndone\n\necho "Build complete: $(ls "$BUILD_DIR" | wc -l) files"'
    };

    var calibResults = {};

    function updateRow(lang, data) {
        var row = document.getElementById('calib-' + lang);
        if (!row) return;
        var cells = row.querySelectorAll('td');
        cells[1].textContent = data.qubits || 'â€”';
        cells[2].textContent = data.gates || 'â€”';
        cells[3].textContent = data.localStates || 'â€”';
        cells[4].textContent = data.qpuStates || 'â€”';
        if (data.fidelity !== undefined) {
            var f = data.fidelity;
            cells[5].textContent = (f * 100).toFixed(1) + '%';
            cells[5].style.color = f > 0.8 ? '#3fb950' : f > 0.5 ? '#d4a017' : '#f85149';
        } else { cells[5].textContent = 'â€”'; }
        cells[6].textContent = data.status;
        cells[6].style.color = data.status === 'Done' ? '#3fb950' : data.status === 'Running' ? '#58a6ff' : '#484f58';
    }

    function updateAverage() {
        var langs = Object.keys(calibResults);
        if (langs.length === 0) return;
        var totalQ = 0, totalG = 0, totalF = 0, fCount = 0;
        langs.forEach(function(l) {
            var r = calibResults[l];
            totalQ += r.qubits; totalG += r.gates;
            if (r.fidelity !== undefined) { totalF += r.fidelity; fCount++; }
        });
        document.getElementById('calib-avg-info').textContent = langs.length + ' circuits | avg ' + Math.round(totalQ/langs.length) + 'q, ' + Math.round(totalG/langs.length) + ' gates';
        if (fCount > 0) {
            var avg = totalF / fCount;
            var el = document.getElementById('calib-avg-fidelity');
            el.textContent = (avg * 100).toFixed(1) + '%';
            el.style.color = avg > 0.8 ? '#3fb950' : avg > 0.5 ? '#d4a017' : '#f85149';
        }
        document.getElementById('calib-avg-status').textContent = langs.length + '/5 done';
        document.getElementById('calib-avg-status').style.color = langs.length === 5 ? '#3fb950' : '#58a6ff';
    }

    document.getElementById('calib-run-local').addEventListener('click', function() {
        var langs = Object.keys(SAMPLES);
        langs.forEach(function(lang) {
            updateRow(lang, { status: 'Running' });
            var result = QP.simulateCircuit(SAMPLES[lang], lang, 1024);
            var numStates = Object.keys(result.counts).length;
            calibResults[lang] = { qubits: result.qubits, gates: result.circuit.depth, localStates: numStates, localCounts: result.counts, status: 'Done' };
            updateRow(lang, calibResults[lang]);
        });
        updateAverage();
    });

    document.getElementById('calib-run-ibm').addEventListener('click', function() {
        var token = document.getElementById('gutter-qpu-token').value.trim();
        if (!token) { alert('Enter IBM Quantum API token in the QPU section above'); return; }
        var backend = document.getElementById('gutter-qpu-backend').value;
        if (backend === 'local') backend = 'ibm_brisbane';
        var langs = Object.keys(SAMPLES);

        function runNext(i) {
            if (i >= langs.length) { updateAverage(); return; }
            var lang = langs[i];
            if (!calibResults[lang] || !calibResults[lang].localCounts) {
                var result = QP.simulateCircuit(SAMPLES[lang], lang, 1024);
                calibResults[lang] = { qubits: result.qubits, gates: result.circuit.depth, localStates: Object.keys(result.counts).length, localCounts: result.counts };
            }
            updateRow(lang, Object.assign({}, calibResults[lang], { status: 'Submitting...' }));
            var circuit = QP.toQuantumCircuit(SAMPLES[lang], lang);
            QP.submitToIBM(circuit, token, backend, 1024).then(function(counts) {
                var numStates = Object.keys(counts).length;
                var fidelity = QP.hellingerFidelity(calibResults[lang].localCounts, counts);
                calibResults[lang].qpuStates = numStates;
                calibResults[lang].fidelity = fidelity;
                calibResults[lang].status = 'Done';
                updateRow(lang, calibResults[lang]);
                updateAverage();
                runNext(i + 1);
            }).catch(function(err) {
                calibResults[lang].status = 'Error: ' + err.message.substring(0, 30);
                updateRow(lang, calibResults[lang]);
                runNext(i + 1);
            });
        }
        runNext(0);
    });
})();

// â”€â”€ PWA + Quantum Sync â”€â”€
if ('serviceWorker' in navigator) navigator.serviceWorker.register('sw.js').catch(() => {});
// ===== QUANTUM PREFIX LIVE SYNC =====
if (QP) {
    QP.onStateChange(function(source, state) { if (source === 'quantum-gutter' || !state) return; });
    QP.broadcastState('quantum-gutter', { coverage: 0, totalLines: 0, classifiedLines: 0, prefixCounts: {}, role: 'showcase' });
    QP.requestStateSync();
}

})();
</script>
</body>
</html>
